---
description: "複雑な関数の特定と分割"
allowed-tools: ["Edit", "MultiEdit", "Read", "Grep", "Glob"]
---

# Refactor Complex Functions

複雑な関数の特定と分割を行います。

## 実行内容

### 1. 複雑な関数の検出・分析
- 循環的複雑度が10以上の関数を検出
- 長すぎる関数（100行以上）の特定
- ネストの深い処理（4層以上）の特定
- 複数の責務を持つ関数の識別

### 2. 複雑度要因の分析
- 条件分岐の多い箇所の特定
- ループ処理の複雑さ評価
- try-catch文の使用状況
- 早期リターンの適用可能性

### 3. 関数の分割・リファクタリング
- 単一責任の原則に基づく関数分割
- 共通処理のヘルパー関数化
- 条件分岐の簡素化
- ネストの削減と可読性向上

### 4. 分割後の最適化
- 分割した関数の適切な命名
- 引数・戻り値の型定義
- 関数間の依存関係整理
- ドキュメント・コメントの追加

## 実行手順

1. **検出フェーズ**: 複雑度の高い関数を特定
2. **分析フェーズ**: 複雑度の要因を分析
3. **設計フェーズ**: 分割方針と新しい関数構造を設計
4. **分割フェーズ**: 実際に関数を分割・リファクタリング
5. **検証フェーズ**: 動作確認とテスト実行

## 複雑度の基準

### 循環的複雑度
- **1-10**: 良好
- **11-20**: 要注意
- **21以上**: 即座に分割推奨

### 関数の行数
- **1-50行**: 良好
- **51-100行**: 要検討
- **101行以上**: 分割推奨

### ネストレベル
- **1-3層**: 良好
- **4-5層**: 要改善
- **6層以上**: 即座に改善推奨

## 分割パターン

- **条件分岐の抽出**: 複雑な条件を判定関数に分離
- **処理ブロックの抽出**: 独立した処理を別関数に抽出
- **データ変換の抽出**: データ変換ロジックを専用関数に分離
- **バリデーションの抽出**: 入力チェックを専用関数に分離

## 注意事項

- 機能に影響しない範囲で分割を行います
- 分割前に必ずバックアップを取ることを推奨
- 分割後は関連テストの実行を必須とします
- パフォーマンスへの影響を考慮した設計を行います

## 使用方法

```
/refactor-complex-functions $ARGUMENTS
```

引数として特定のディレクトリやファイルを指定できます。

### 例：
```
/refactor-complex-functions
/refactor-complex-functions src/renderer/components/
/refactor-complex-functions src/main/services/LauncherService.ts
```