---
description: "大きなファイルの特定と分割"
allowed-tools: ["Edit", "MultiEdit", "Read", "Grep", "Glob"]
---

# Refactor Large Files

大きなファイルの特定と分割を行います。

## 実行内容

### 1. 大きなファイルの検出・分析
- 500行を超える大きなファイルの特定
- ファイルサイズと複雑度の相関分析
- 責務の混在状況の評価
- 依存関係の複雑さ分析

### 2. ファイル構造の分析
- クラス・関数・インターフェースの配置状況
- 関連性の高い処理グループの特定
- 単一責任原則の遵守状況評価
- エクスポート・インポート関係の整理

### 3. ファイルの分割・リファクタリング
- 関連性の高い機能をモジュールとして分離
- 責務に応じたファイル分割
- 共通処理のユーティリティファイル化
- 型定義の専用ファイル分離

### 4. 分割後の最適化
- 適切なディレクトリ構造への配置
- インポート・エクスポート文の最適化
- 循環依存の解消
- 命名規則の統一

## 実行手順

1. **検出フェーズ**: 大きなファイルを特定
2. **分析フェーズ**: ファイル内容と責務を分析
3. **設計フェーズ**: 分割方針と新しいファイル構造を設計
4. **分割フェーズ**: 実際にファイルを分割・リファクタリング
5. **検証フェーズ**: 動作確認とテスト実行

## ファイルサイズの基準

### 行数による分類
- **1-200行**: 良好
- **201-500行**: 要検討
- **501-1000行**: 分割推奨
- **1001行以上**: 即座に分割推奨

### 機能数による分類
- **1-5個の機能**: 良好
- **6-10個の機能**: 要検討
- **11個以上の機能**: 分割推奨

## 分割パターン

### 機能別分割
- **コンポーネント**: UI関連の機能をまとめて分離
- **サービス**: ビジネスロジックを機能別に分離
- **ユーティリティ**: 汎用的な処理を用途別に分離
- **型定義**: インターフェース・型を専用ファイルに分離

### 責務別分割
- **データ層**: データアクセス・API通信
- **ビジネス層**: ビジネスロジック・処理
- **プレゼンテーション層**: UI・表示ロジック
- **共通層**: 共通処理・ユーティリティ

## 分割後の構成例

```
// 分割前
LauncherService.ts (800行)

// 分割後
services/
├── LauncherService.ts (150行) - メインサービス
├── FileHandler.ts (120行) - ファイル操作
├── IconManager.ts (100行) - アイコン管理
├── HotkeyManager.ts (90行) - ホットキー管理
├── types.ts (80行) - 型定義
└── utils.ts (60行) - ユーティリティ
```

## 注意事項

- 機能に影響しない範囲で分割を行います
- 分割前に必ずバックアップを取ることを推奨
- 分割後は関連テストの実行を必須とします
- パフォーマンスへの影響を考慮した設計を行います
- 循環依存が発生しないよう注意します

## 使用方法

```
/refactor-large-files $ARGUMENTS
```

引数として特定のディレクトリやファイルを指定できます。

### 例：
```
/refactor-large-files
/refactor-large-files src/renderer/
/refactor-large-files src/main/services/LauncherService.ts
```