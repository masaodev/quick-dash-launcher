# メインウィンドウ仕様書

## 関連ドキュメント

- [画面一覧](./screen-list.md) - 全画面構成の概要
- [ブックマークインポートモーダル](./bookmark-import-modal.md) - インポート機能詳細
- [アイテム管理](../../manual/item-management.md) - 編集機能の詳細

## 1. 概要

メインウィンドウは、QuickDashLauncherの中核となる検索・ランチャー画面です。グローバルホットキー（Alt+Space）で呼び出され、アプリケーション、ファイル、フォルダ、URLに素早くアクセスできます。

**注意**: 初回起動時（`hotkey`が空文字列または未設定の場合）は、メインウィンドウの代わりに[初回設定画面](./first-launch-setup.md)が表示されます。初回設定完了後、このメインウィンドウが表示されるようになります。

**キーボードショートカット**:
- Alt+Space: ウィンドウ表示/非表示（デフォルト、設定で変更可能）
- Ctrl+E: アイテム管理ウィンドウへ切り替え
- Enter: 選択項目を開く
- Shift+Enter: 選択項目の親フォルダを開く
- Arrow Keys: 項目選択の移動
- Tab/Shift+Tab: タブ切り替え（タブ表示有効時、複数タブ存在時のみ）

### 主要機能
- **リアルタイム検索**: 入力に応じてアイテムをリアルタイムフィルタリング
- **キーボードナビゲーション**: 矢印キーとEnterキーでアイテム選択・実行
- **コンテキストメニュー**: 右クリックでアイテム操作メニューを表示
- **ドラッグ&ドロップ登録**: ファイルやフォルダをドロップして簡単登録
- **ウィンドウ固定化**: 📌ボタンでフォーカスアウト時も非表示にならない設定
- **アイコン管理**: ファビコン取得・アイコン抽出機能
- **進捗表示**: アイコン処理中の進捗バー表示
- **詳細情報表示**: アイテムにマウスホバーでパス、データ元、行番号、フォルダ取込情報をツールチップ表示

## 2. 基本情報

| 項目 | 内容 |
|------|------|
| **ファイル名** | `src/renderer/App.tsx` |
| **コンポーネント名** | `App` |
| **表示条件** | グローバルホットキー（Alt+Space、デフォルト）押下時 |
| **画面タイプ** | メインウィンドウ |
| **親画面** | なし（ルートコンポーネント） |

## 3. 画面項目一覧

| エリア | 項目名 | 内容・説明 | 表示条件 | 機能詳細 |
|--------|--------|------------|----------|----------|
| **タブバー** | データファイルタブ | データファイル切り替え用のタブボタン | タブ表示ON時 | [4.20](#420-データファイルタブをクリック) |
| **ヘッダー** | 検索入力欄 | アイテム検索用のテキスト入力欄、クリアボタン付き | 常時表示 | [4.1](#41-検索入力欄への文字入力) |
| **ヘッダー** | アイテム登録ボタン（➕） | アイテム登録モーダルを開く | 常時表示 | [4.19](#419-アイテム登録ボタン押下) |
| **ヘッダー** | 更新ボタン（🔄） | データ再読み込み・アイコン取得メニュー | 常時表示 | [4.3](#43-更新メニュー操作) |
| **ヘッダー** | └ 📋 データ再読み込み | データファイルの再読み込み | ドロップダウン展開時 | [4.3](#43-更新メニュー操作) |
| **ヘッダー** | └ 🎨 アイコン取得 | 未取得アイコンの取得 | ドロップダウン展開時 | [4.3](#43-更新メニュー操作) |
| **ヘッダー** | └ 🔄 完全リフレッシュ | データ再読み込み＋全アイコン強制取得 | ドロップダウン展開時 | [4.3](#43-更新メニュー操作) |
| **ヘッダー** | 固定ボタン（📌） | ウィンドウ固定状態の切り替え | 常時表示 | [4.4](#44-固定ボタン押下) |
| **ヘッダー** | 設定ボタン（⚙） | 設定・管理メニューへのアクセス | 常時表示 | [4.5](#45-設定メニュー操作) |
| **ヘッダー** | └ ⚙️ 基本設定 | 管理ウィンドウの設定タブを開く | ドロップダウン展開時 | [4.5](#45-設定メニュー操作) |
| **ヘッダー** | └ ✏️ アイテム管理 | 管理ウィンドウの編集タブを開く | ドロップダウン展開時 | [4.5](#45-設定メニュー操作) |
| **ヘッダー** | └ ──────────── | 区切り線 | ドロップダウン展開時 | - |
| **ヘッダー** | └ 🚪 アプリを終了 | アプリケーションを終了 | ドロップダウン展開時 | [4.5](#45-設定メニュー操作) |
| **メイン** | アイテムリスト | フィルタリングされたアイテム一覧表示 | 常時表示 | [4.6](#46-アイテムをクリック) |
| **メイン** | 選択ハイライト | 現在選択中のアイテムをハイライト表示 | アイテム存在時 | [4.7](#47-検索入力欄で-enter-キー押下) |
| **メイン** | 詳細ツールチップ | アイテムホバー時にパス、データ元、行番号、フォルダ取込情報を表示 | ホバー時 | [4.17](#417-アイテムにマウスホバー) |
| **メイン** | コンテキストメニュー | 右クリック時に表示されるアイテムメニュー（ツールチップ付き） | 右クリック時 | [4.10](#410-アイテムを右クリック) |
| **メイン** | 進捗バー | アイコン処理の進捗表示 | 処理実行中 | - |
| **オーバーレイ** | 登録モーダル | ドラッグ&ドロップ時の登録用モーダル | ドロップ時 | [4.12](#412-ドラッグドロップ操作) |
| **オーバーレイ** | ドラッグオーバーレイ | ドラッグ中の視覚的フィードバック | ドラッグ中 | [4.12](#412-ドラッグドロップ操作) |

## 4. アクション一覧

| No | アクション名 | トリガー | 主な処理内容 | 詳細 |
|----|------------|---------|------------|------|
| 4.1 | 検索入力欄への文字入力 | テキスト入力 | アイテムのリアルタイムフィルタリング | [詳細](#41-検索入力欄への文字入力) |
| 4.2 | 検索入力欄のクリアボタン押下 | クリアボタン（×）クリック | 入力内容をクリア、全アイテム表示 | [詳細](#42-検索入力欄のクリアボタン押下) |
| 4.3 | 更新メニュー操作 | 更新ボタン（🔄）クリック / メニュー選択 | データ再読み込み、アイコン取得、完全リフレッシュ | [詳細](#43-更新メニュー操作) |
| 4.4 | 固定ボタン押下 | 固定ボタン（📌）クリック | ウィンドウ固定状態の切り替え | [詳細](#44-固定ボタン押下) |
| 4.5 | 設定メニュー操作 | 設定ボタン（⚙）クリック / メニュー選択 / Ctrl+E | 基本設定、アイテム管理、JSON出力、終了 | [詳細](#45-設定メニュー操作) |
| 4.6 | アイテムをクリック | アイテムクリック | 選択アイテムの実行（開く） | [詳細](#46-アイテムをクリック) |
| 4.7 | 検索入力欄で Enter キー押下 | Enterキー | 選択中のアイテムを開く | [詳細](#47-検索入力欄で-enter-キー押下) |
| 4.8 | 検索入力欄で Shift+Enter キー押下 | Shift+Enterキー | 選択中のアイテムの親フォルダを開く | [詳細](#48-検索入力欄で-shiftenter-キー押下) |
| 4.9 | 検索入力欄で ArrowUp/ArrowDown キー押下 | ArrowUp/ArrowDownキー | アイテム選択の移動（循環） | [詳細](#49-検索入力欄で-arrowuparrowdown-キー押下) |
| 4.10 | アイテムを右クリック | アイテム右クリック | コンテキストメニュー表示 | [詳細](#410-アイテムを右クリック) |
| 4.11 | コンテキストメニューから「パスをコピー」選択 | メニュー項目選択 | アイテムパスをクリップボードにコピー | [詳細](#411-コンテキストメニューからパスをコピー選択) |
| 4.12 | コンテキストメニューから「親フォルダーのパスをコピー」選択 | メニュー項目選択 | アイテムの親フォルダーパスをクリップボードにコピー | [詳細](#412-コンテキストメニューから親フォルダーのパスをコピー選択) |
| 4.13 | コンテキストメニューから「親フォルダーを開く」選択 | メニュー項目選択 | エクスプローラーで親フォルダーを開く | [詳細](#413-コンテキストメニューから親フォルダーを開く選択) |
| 4.14 | コンテキストメニュー項目にマウスホバー | メニュー項目にホバー | 対象パスをツールチップ表示 | [詳細](#414-コンテキストメニュー項目にマウスホバー) |
| 4.15 | ドラッグ&ドロップ操作 | ドラッグ / ドロップ操作 | ファイル・フォルダの登録 | [詳細](#415-ドラッグドロップ操作) |
| 4.16 | ウィンドウ表示時の初期化 | グローバルホットキー（デフォルト: Alt+Space） | データ読み込み、アイコン適用、画面初期化 | [詳細](#416-ウィンドウ表示時の初期化) |
| 4.17 | アイテムにマウスホバー | アイテムにマウスカーソルをホバー | 実行パス（引数含む）をツールチップ表示 | [詳細](#417-アイテムにマウスホバー) |
| 4.18 | コンテキストメニューから「編集」選択 | メニュー項目選択 | アイテム編集モーダルを開く | [詳細](#418-コンテキストメニューから編集選択) |
| 4.19 | アイテム登録ボタン押下 | 登録ボタン（➕）クリック | アイテム登録モーダルを開く | [詳細](#419-アイテム登録ボタン押下) |
| 4.20 | データファイルタブをクリック | タブボタンクリック | アクティブなデータファイルを切り替え | [詳細](#420-データファイルタブをクリック) |
| 4.21 | Tab/Shift+Tabキー押下 | Tab/Shift+Tabキー | タブの切り替え | [詳細](#421-tabshifttabキー押下) |

## 5. 機能詳細

### 4.1. 検索入力欄への文字入力

#### アクション
- 検索入力欄に文字を入力

#### 処理フロー
1. 入力値変更時に`handleSearch`を実行
2. `filterItems`関数でアイテムをフィルタリング（アイテム名の部分一致、大文字小文字区別なし）
3. `selectedIndex`を0にリセット（最初のアイテムを選択）
4. フィルタリングされたアイテムリストを表示

#### 関連アクション
- ウィンドウ表示時に検索入力欄に自動フォーカス

### 4.2. 検索入力欄のクリアボタン押下

#### アクション
- 検索入力欄の「×」ボタンをクリック

#### 処理フロー
1. 入力内容をクリア
2. 全アイテムを表示
3. `selectedIndex`を0にリセット

#### 表示条件
- テキストが入力されている時のみ「×」ボタンを表示

### 4.3. 更新メニュー操作

#### アクション
- ヘッダーの更新ボタン（🔄）をクリックしてメニューを開き、メニュー項目を選択

#### メニュー項目と処理フロー

**📋 データ再読み込み:**
1. データファイル（data.txt）を再読み込み
2. パースしてアイテム配列に変換
3. アイコンキャッシュを適用
4. アイテムリストを更新
5. メニューを閉じる

**🎨 アイコン取得:**
1. アイコンが未取得のアイテムを検索
2. URLアイテムのファビコン取得を実行
3. 実行ファイル（.exe）のアイコン抽出を実行
4. 進捗バーで処理状況を表示
5. 完了後、メニューを閉じる

**🔄 完全リフレッシュ:**
1. データファイルを再読み込み
2. すべてのアイテムのアイコンを強制再取得（既存キャッシュを無視）
3. 進捗バーで処理状況を表示
4. 完了後、メニューを閉じる

#### 各メニュー項目の違い
- **データ再読み込み**: アイコンには影響せず、データファイルのみ再読み込み
- **アイコン取得**: データは再読み込みせず、未取得アイコンのみ取得
- **完全リフレッシュ**: データ再読み込み＋すべてのアイコンを強制再取得（最も包括的）

#### 共通動作
- メニュー外をクリックすると自動的にメニューを閉じる
- メニュー項目選択後は自動的にメニューを閉じる

### 4.4. 固定ボタン（📌）押下

#### アクション
- ヘッダーの固定ボタン（📌）をクリック

#### 処理フロー
1. 現在の固定状態を反転（固定 ⇔ 固定解除）
2. `window.electronAPI.setWindowPinState`でメインプロセスに状態を送信
3. ボタンに`pinned`クラスを適用/解除
4. ツールチップを更新（「ウィンドウ固定を解除」⇔「ウィンドウを固定」）

#### 動作
- **固定時**: フォーカスアウトしてもウィンドウが非表示にならない
- **固定解除時**: フォーカスアウトするとウィンドウが自動的に非表示になる

### 4.5. 設定メニュー操作

#### アクション
- ヘッダーの設定ボタン（⚙）をクリックしてメニューを開き、メニュー項目を選択
- または、Ctrl+Eキーを押下（アイテム管理へのショートカット）

#### メニュー項目と処理フロー

**⚙️ 基本設定:**
1. `openEditWindowWithTab('settings')`を実行
2. 管理ウィンドウを「設定」タブで開く
3. メニューを閉じる

**✏️ アイテム管理:**
1. `openEditWindowWithTab('edit')`を実行
2. 管理ウィンドウを「編集」タブで開く
3. メニューを閉じる
- **ショートカット**: Ctrl+Eキーでも同じ動作

**🚪 アプリを終了:**
1. `window.electronAPI.quitApp`を実行
2. アプリケーションを終了

#### 各メニュー項目の違い
- **基本設定**: ホットキー、ウィンドウサイズ等の設定変更
- **アイテム管理**: data.txtの内容を直接編集
- **アプリを終了**: アプリケーションの終了

#### 共通動作
- メニュー外をクリックすると自動的にメニューを閉じる
- メニュー項目選択後は自動的にメニューを閉じる（アプリ終了を除く）

### 4.6. アイテムをクリック

#### アクション
- アイテムリスト内のアイテムをクリック

#### 処理フロー
1. `window.electronAPI.openItem(item)`を実行
2. アイテムの種別に応じて実行：
   - URL: デフォルトブラウザで開く
   - ファイル: 関連付けられたアプリで開く
   - フォルダ: エクスプローラーで開く
   - アプリケーション: 実行ファイルを起動
3. ウィンドウを非表示（固定されていない場合）

### 4.7. 検索入力欄で Enter キー押下

#### アクション
- 検索入力欄でEnterキーを押下

#### 処理フロー
1. 現在選択中のアイテム（`selectedIndex`）を取得
2. アイテムが存在する場合、`window.electronAPI.openItem(item)`を実行
3. アイテムの種別に応じて実行（4.6と同様）
4. ウィンドウを非表示（固定されていない場合）

#### エラーハンドリング
- アイテムが存在しない場合は何も実行しない

### 4.8. 検索入力欄で Shift+Enter キー押下

#### アクション
- 検索入力欄でShift+Enterキーを押下

#### 処理フロー
1. 現在選択中のアイテム（`selectedIndex`）を取得
2. `window.electronAPI.openParentFolder(item)`を実行
3. アイテムの親フォルダをエクスプローラーで開く
4. ウィンドウを非表示（固定されていない場合）

### 4.9. 検索入力欄で ArrowUp/ArrowDown キー押下

#### アクション
- 検索入力欄でArrowUpキーまたはArrowDownキーを押下

#### 処理フロー

**ArrowUpキー押下時:**
1. `selectedIndex`を1減らす
2. インデックスが0未満の場合、末尾のアイテムにループ
3. 選択中のアイテムをハイライト表示
4. 必要に応じてスクロール

**ArrowDownキー押下時:**
1. `selectedIndex`を1増やす
2. インデックスが末尾を超える場合、先頭のアイテムにループ
3. 選択中のアイテムをハイライト表示
4. 必要に応じてスクロール

#### 動作の違い
- **ArrowUp**: 選択を**上方向（前のアイテム）**に移動。先頭で押下すると末尾にループ
- **ArrowDown**: 選択を**下方向（次のアイテム）**に移動。末尾で押下すると先頭にループ

#### 共通動作
- どちらのキーも循環選択をサポート（リストの端に到達すると反対側にループ）
- 選択されたアイテムは自動的にビュー内にスクロール
- ハイライト表示により現在選択中のアイテムが視覚的に明確

### 4.10. アイテムを右クリック

#### アクション
- アイテムリスト内のアイテムを右クリック

#### 処理フロー
1. クリック位置（マウス座標）を取得
2. 画面端の場合は表示位置を自動調整
3. コンテキストメニューを表示
4. 以下のメニュー項目を表示：
   - ✏️ 編集（常に表示）
   - 📋 パスをコピー（常に表示）
   - 📁 親フォルダーのパスをコピー（ファイル・フォルダ・アプリのみ）
   - 📂 親フォルダーを開く（ファイル・フォルダ・アプリのみ）
   - 🔗 ショートカットのパスをコピー（.lnkファイルのみ）
   - 📂 ショートカットの親フォルダーのパスをコピー（.lnkファイルのみ）

#### メニュー項目
- **✏️ 編集**: アイテム編集モーダルを開く（すべてのアイテムタイプで表示）

#### 表示条件
- **編集**: すべてのアイテムタイプで表示
- **URL・カスタムURI**: 「パスをコピー」のみ表示
- **ファイル・フォルダ・アプリ**: 「パスをコピー」「親フォルダーのパスをコピー」「親フォルダーを開く」を表示
- **.lnkファイル**: 上記に加えてショートカット関連のメニューも表示

#### ツールチップ機能
- 各メニュー項目にマウスホバーすると、対象となるパスがツールチップで表示される
- 実際にコピーまたは開く対象のパスを事前確認できる

#### メニューを閉じる操作
- メニュー外をクリック
- Escapeキーを押下
- メニュー項目選択後は自動的に閉じる

### 4.11. コンテキストメニューから「パスをコピー」選択

#### アクション
- コンテキストメニューから「📋 パスをコピー」を選択

#### 処理フロー
1. 選択中のアイテムのパス（ファイルパス・URL等）を取得
2. 引数が設定されている場合は、パスと引数を結合して完全なコマンドラインを生成
3. `window.electronAPI.copyToClipboard`でクリップボードにコピー
4. 成功通知を表示
5. メニューを閉じる

#### コピー例
- **引数なし**: `C:\Windows\System32\notepad.exe`
- **引数あり**: `C:\Program Files\Microsoft VS Code\Code.exe --new-window`
  - パス: `C:\Program Files\Microsoft VS Code\Code.exe`
  - 引数: `--new-window`
  - コピー内容: `C:\Program Files\Microsoft VS Code\Code.exe --new-window`

#### 動作の詳細
- 引数が設定されていないアイテムの場合は、パスのみをコピー
- 引数が設定されているアイテムの場合は、パスと引数をスペースで結合した完全なコマンドラインをコピー
- ターミナルやバッチファイルなどにそのまま貼り付けて使用可能

#### エラーハンドリング
- コピー失敗時はアラート表示

### 4.12. コンテキストメニューから「親フォルダーのパスをコピー」選択

#### アクション
- コンテキストメニューから「📁 親フォルダーのパスをコピー」を選択

#### 処理フロー
1. 選択中のアイテムのタイプを確認
2. URLまたはカスタムURIの場合はエラーアラートを表示（親フォルダーが存在しないため）
3. ファイル、フォルダ、アプリケーションの場合：
   - アイテムのパスから最後のスラッシュ/バックスラッシュを検索
   - 親ディレクトリパスを抽出
   - `window.electronAPI.copyToClipboard`でクリップボードにコピー
   - 成功通知を表示
4. メニューを閉じる

#### 対応アイテムタイプ
- **対応**: ファイル、フォルダ、アプリケーション
- **非対応**: URL、カスタムURI（警告メッセージを表示）

#### コピー例
- `C:\Users\username\Documents\file.txt` → `C:\Users\username\Documents`
- `/home/user/files/app.exe` → `/home/user/files`

#### エラーハンドリング
- URLまたはカスタムURIの場合: 「URLおよびカスタムURIには親フォルダーがありません」と表示
- 親フォルダーパスの取得失敗時: 「親フォルダーのパスを取得できませんでした」と表示
- コピー失敗時: アラート表示

### 4.13. コンテキストメニューから「親フォルダーを開く」選択

#### アクション
- コンテキストメニューから「📂 親フォルダーを開く」を選択

#### 処理フロー
1. 選択中のアイテムの `window.electronAPI.openParentFolder(item)` を実行
2. `shell.showItemInFolder()` でエクスプローラーを起動
3. 親フォルダーを開き、アイテムを選択状態で表示
4. メニューを閉じる
5. ウィンドウを非表示（固定されていない場合）

#### 対応アイテムタイプ
- **対応**: ファイル、フォルダ、アプリケーション
- **非対応**: URL、カスタムURI（メニュー項目自体が表示されない）

#### 動作例
- `C:\Users\username\Documents\file.txt` → エクスプローラーで `C:\Users\username\Documents` を開き、`file.txt` を選択状態で表示
- `C:\Program Files\MyApp\app.exe` → エクスプローラーで `C:\Program Files\MyApp` を開き、`app.exe` を選択状態で表示

#### 用途
- アイテムの保存場所を素早く確認したい場合
- 同じフォルダ内の他のファイルを確認したい場合
- エクスプローラーでファイル操作を行いたい場合

#### Shift+Enterとの違い
- **Shift+Enter**: 選択中のアイテムに対して実行（キーボード操作）
- **右クリックメニュー**: 右クリックしたアイテムに対して実行（マウス操作）
- 両方とも同じ `openParentFolder` 機能を使用

#### エラーハンドリング
- 親フォルダーを開くのに失敗した場合: アラート表示

### 4.14. コンテキストメニュー項目にマウスホバー

#### アクション
- コンテキストメニューの各項目にマウスカーソルをホバー

#### 処理フロー
1. メニュー項目要素の `title` 属性に対象パスが設定される
2. ブラウザのネイティブツールチップが自動的に表示される
3. ツールチップには以下の内容が表示される：

**パスをコピー:**
- 引数なし: `item.path`
- 引数あり: `item.path + " " + item.args`（完全なコマンドライン）

**親フォルダーのパスをコピー / 親フォルダーを開く:**
- 親ディレクトリのパス（最後のスラッシュ/バックスラッシュまでのパス）

**ショートカットのパスをコピー:**
- `item.originalPath`（.lnkファイルのパス）

**ショートカットの親フォルダーのパスをコピー:**
- ショートカットファイルの親ディレクトリパス

#### 表示例

```
📋 パスをコピー
→ C:\Program Files\Microsoft VS Code\Code.exe --new-window

📁 親フォルダーのパスをコピー
→ C:\Program Files\Microsoft VS Code

📂 親フォルダーを開く
→ C:\Program Files\Microsoft VS Code

🔗 ショートカットのパスをコピー
→ C:\Users\username\Desktop\MyApp.lnk

📂 ショートカットの親フォルダーのパスをコピー
→ C:\Users\username\Desktop
```

#### 用途
- 実際にコピー/開く対象のパスを事前確認
- 長いパスや引数の内容を確認
- 操作ミスを防ぐ

#### 動作の詳細
- ホバー時に自動的に表示（マウスをメニュー項目上に置くだけで表示）
- ブラウザのネイティブツールチップを使用（OSの設定に従った表示タイミング）
- マウスを離すと自動的に非表示

### 4.15. ドラッグ&ドロップ操作

#### アクション
- ファイルまたはフォルダをウィンドウにドラッグ&ドロップしてアイテム登録

#### 処理フロー

**ドラッグ中（ドロップ前）:**
1. `setIsDraggingOver(true)`で状態を更新
2. 半透明オーバーレイを表示
3. 「ファイルをドロップして登録」メッセージを表示
4. `dragging-over`クラスをアプリ全体に適用

**ドロップ時:**
1. `handleDrop`イベントでファイルを取得
2. `window.electronAPI.getPathForFile`でファイルパスを取得
3. 複数ファイルの場合はパス配列を作成
4. `RegisterModal`を開いて登録フローへ
5. 設定から`dataFileTabs`を読み込み、保存先選択肢を構築
6. `setIsDraggingOver(false)`でオーバーレイを非表示

#### 保存先選択
- **選択肢**: `dataFileTabs`設定で定義されたタブ（データファイル）のリスト
- **デフォルト選択**: `dataFileTabs`配列の最初のタブ
- **ユーザー変更可能**: モーダル内で任意のタブに変更可能

#### 動作の違い
- **ドラッグ中**: 視覚的フィードバック（オーバーレイ・メッセージ）の表示
- **ドロップ時**: 実際の登録処理の開始

#### エラーハンドリング
- パス取得失敗時: アラート「ファイルパスを取得できませんでした」を表示

### 4.16. ウィンドウ表示時の初期化

#### アクション
- グローバルホットキー（Alt+Space、デフォルト）でウィンドウを表示

#### 処理フロー
1. データファイル（data.txt）を読み込み
2. `parseDataFiles`でアイテム配列に変換
3. アイコンキャッシュを適用
4. アイテムリストを表示
5. 検索入力欄に自動フォーカス
6. `window.electronAPI.getWindowPinState`で固定状態を取得
7. 固定ボタンの状態を反映

### 4.17. アイテムにマウスホバー

#### アクション
- アイテムリスト内のアイテムにマウスカーソルをホバー

#### 処理フロー
1. アイテム要素の`title`属性にツールチップ情報が設定される
2. ブラウザのネイティブツールチップが自動的に表示される
3. ツールチップには以下の内容が表示される：

**通常のアイテム（LauncherItem）の場合:**
- **パス情報**（最初に表示）
  - 引数なし: `item.path`のみ
  - 引数あり: `item.path + " " + item.args`（完全なコマンドライン）
- **空行**
- **データ元**: アイテムが定義されているファイル（data.txt または data2.txt）
- **行番号**: データファイル内の行番号
- **取込元**: フォルダ取込から展開されたアイテムの場合のみ、元ディレクトリパス
- **設定**: フォルダ取込から展開されたアイテムの場合のみ、フォルダ取込のオプション情報

**グループアイテムの場合:**
- **グループ情報**: `グループ: アイテム名1, アイテム名2, ...`
- **空行**
- **データ元**: データファイル名
- **行番号**: データファイル内の行番号

#### 表示例

**通常アイテム（引数なし）:**
```
C:\Users\Desktop\myapp.exe

データ元: data.txt
行番号: 10
```

**通常アイテム（引数あり）:**
```
C:\Program Files\Microsoft VS Code\Code.exe --new-window

データ元: data.txt
行番号: 15
```

**フォルダ取込から展開されたアイテム:**
```
C:\Work\projects\myproject\readme.pdf

データ元: data.txt
行番号: 15
取込元: C:\Work\projects
設定: 深さ:2, タイプ:ファイルのみ, フィルター:*.pdf
```

**グループアイテム:**
```
グループ: Google, GitHub, Qiita

データ元: data.txt
行番号: 25
```

#### フォルダ取込オプション情報の表示形式

フォルダ取込から展開されたアイテムの場合、「設定」行に以下の形式でオプション情報が表示されます：

- **深さ**: `深さ:2` または `深さ:無制限`
- **タイプ**: `タイプ:ファイルのみ` / `タイプ:フォルダのみ` / `タイプ:ファイルとフォルダ`
- **フィルター**: `フィルター:*.pdf` （設定されている場合のみ）
- **除外**: `除外:*.tmp` （設定されている場合のみ）
- **接頭辞**: `接頭辞:Doc: ` （設定されている場合のみ）
- **接尾辞**: `接尾辞: (backup)` （設定されている場合のみ）

例：`深さ:2, タイプ:ファイルのみ, フィルター:*.{pdf,docx}, 除外:*.tmp, 接頭辞:Work: `

#### 用途
- アイテムの実行パスを確認したい場合
- 引数が設定されているか確認したい場合
- コマンドラインの完全な形式を知りたい場合
- アイテムがどのデータファイルの何行目に定義されているか確認したい場合
- フォルダ取込から展開されたアイテムの元ディレクトリや設定を確認したい場合
- グループに含まれるアイテムを確認したい場合

#### 動作の詳細
- ホバー時に自動的に表示（マウスをアイテム上に置くだけで表示）
- ブラウザのネイティブツールチップを使用（OSの設定に従った表示タイミング）
- マウスを離すと自動的に非表示
- 複数行の情報を見やすく整形して表示

### 4.18. コンテキストメニューから「編集」選択

#### アクション
- コンテキストメニューから「✏️ 編集」を選択

#### 処理フロー
1. 選択中のアイテムを`LauncherItem`から`RawDataLine`形式に変換
2. フォルダ取込から展開されたアイテム（`isDirExpanded: true`）の場合:
   - `loadRawDataFiles` APIで元のディレクティブ行を取得
   - 元の行番号とデータファイル情報を保持
3. `RegisterModal`を編集モードで開く
4. 設定から`dataFileTabs`を読み込み、保存先選択肢を構築
5. モーダル表示中はウィンドウが非表示にならない（モーダルモード）
6. メニューを閉じる

#### 動作の詳細
- **通常アイテム**: CSVフォーマットで編集可能
- **フォルダ取込ディレクティブ**: `dir,`で始まるディレクティブ行として編集
  - 元の行番号を保持して直接更新
  - `updateRawLine` APIで生データを更新

#### モーダルでの編集内容
- **単一アイテム**: 名前、パス、引数、保存先、カスタムアイコンを編集可能
- **フォルダ取込ディレクティブ**:
  - パス、保存先、フォルダ取込オプション（深さ、タイプ、フィルター等）を編集可能
  - 名前フィールドは読み取り専用（ハイフン表示）
- **グループ**: グループ名、保存先、アイテム名リストを編集可能

#### 保存先選択
- **選択肢**: `dataFileTabs`設定で定義されたタブ（データファイル）のリスト
- **表示形式**: タブ名（`dataFileTabs[].name`）
- **編集時のデフォルト**: アイテムが現在保存されているデータファイル
- **動的更新**: 設定でタブが追加・削除されると、選択肢も自動的に更新される

#### 保存処理
- **通常アイテム**: `updateItem` APIでCSV形式で保存
- **フォルダ取込ディレクティブ**: `updateRawLine` APIで生データ行を直接保存
- **保存先変更時**: 選択されたデータファイルに保存（異なるファイルへの移動も可能）
- バックアップ自動作成
- データ再読み込みで画面に反映

### 4.19. アイテム登録ボタン押下

#### アクション
- ヘッダーのアイテム登録ボタン（➕）をクリック

#### 処理フロー
1. `handleOpenRegisterModal`を実行
2. `RegisterModal`を新規登録モードで開く
3. 設定から`dataFileTabs`を読み込み、保存先選択肢を構築
4. モーダル表示中はウィンドウが非表示にならない（モーダルモード）
5. ユーザーがアイテム情報を入力して保存
6. 選択された保存先タブ（データファイル）に追加
7. データ再読み込みで画面に反映

#### 保存先選択
- **選択肢**: `dataFileTabs`設定で定義されたタブ（データファイル）のリスト
- **表示形式**: タブ名（`dataFileTabs[].name`）
- **デフォルト選択**: `dataFileTabs`配列の最初のタブ
- **動的更新**: 設定でタブが追加・削除されると、選択肢も自動的に更新される

#### ボタン配置
- ヘッダーの一番左（更新ボタンの前）

#### モーダルモード
- モーダル表示中はフォーカスアウトでもウィンドウが非表示にならない
- モーダルを閉じると通常のフォーカスアウト動作に戻る

### 4.20. データファイルタブをクリック

#### アクション
- タブバーのタブボタンをクリック

#### 処理フロー
1. クリックされたタブに対応するデータファイル名を取得
2. `setActiveTab`でアクティブなタブを変更
3. アクティブなタブのデータファイルに含まれるアイテムのみを表示
4. 検索クエリはクリア
5. 選択インデックスを0にリセット

#### タブの表示条件
- **設定でタブ表示がON**: `showDataFileTabs: true`の場合のみタブバーが表示される
- **設定でタブ表示がOFF**: タブバーは非表示、data.txtのみが表示される

#### タブの表示内容
- **タブラベル**: `dataFileTabs`配列の`name`フィールド、またはデフォルトタブ名、またはファイル名
  - `name`フィールドに値が設定されている場合は、その名前を表示
  - `name`フィールドが空文字列の場合は、デフォルトタブ名を表示（data.txt → 「メイン」、data2.txt → 「サブ1」）
  - デフォルトタブ名がない場合はファイル名を表示
- **アクティブ状態**: 現在選択中のタブは視覚的にハイライト表示
- **ツールチップ**: タブにホバーすると元のファイル名（例: `data.txt`）が表示される
- **リアルタイム更新**: 管理ウィンドウでタブ名を変更すると、即座にメインウィンドウのタブ名が更新される

#### タブの表示順序
- **配列順序**: `dataFileTabs`配列の要素の順序がそのままタブの表示順序になります
- **順序変更**: 管理ウィンドウの▲▼ボタンで順序を変更可能
- **リアルタイム更新**: 順序変更も即座にメインウィンドウに反映されます

#### アクティブタブの初期化
- **アプリ起動時**: `defaultFileTab`設定で指定されたタブを表示
- **タブが存在しない場合**: 自動的にdata.txtにフォールバック
- **ウィンドウ表示時**: 前回のアクティブタブを記憶して表示

#### データの自動フィルタリング
- アクティブなタブのデータファイル（`sourceFile`プロパティ）に一致するアイテムのみを表示
- フォルダ取込アイテムから展開されたアイテムも、元のディレクティブの`sourceFile`に基づいてフィルタリング

#### 関連設定
- **タブ表示設定**: `showDataFileTabs` - タブバーの表示/非表示
- **デフォルトタブ**: `defaultFileTab` - 起動時のアクティブタブ
- **タブ設定**: `dataFileTabs` - 各タブの名前と表示順序を管理する配列

詳細は **[アプリケーション設定](../../manual/app-settings.md#タブ表示設定)** を参照してください。
### 4.21. Tab/Shift+Tabキー押下

#### アクション
- 検索入力欄でTabキーまたはShift+Tabキーを押下

#### 処理フロー

**Tabキー押下時:**
1. タブ表示設定が有効で、複数のタブが存在するか確認
2. 現在のアクティブタブのインデックスを取得
3. 次のタブのインデックスを計算（末尾の場合は先頭にループ）
4. `setActiveTab`で次のタブをアクティブに変更
5. 選択インデックスを0にリセット

**Shift+Tabキー押下時:**
1. タブ表示設定が有効で、複数のタブが存在するか確認
2. 現在のアクティブタブのインデックスを取得
3. 前のタブのインデックスを計算（先頭の場合は末尾にループ）
4. `setActiveTab`で前のタブをアクティブに変更
5. 選択インデックスを0にリセット

#### 表示条件
- **タブ表示がON**: `showDataFileTabs: true`の場合のみ動作
- **複数タブが存在**: 2つ以上のタブが存在する場合のみ動作
- 条件を満たさない場合、Tabキーはブラウザのデフォルト動作（フォーカス移動）

#### タブの順序
- タブ順序設定（`tabOrder`）に従って循環
- カスタム順序が設定されていない場合は、ファイル名の自然順で循環

#### 動作の違い
- **Tab**: 次のタブへ移動（右方向）。末尾で押下すると先頭にループ
- **Shift+Tab**: 前のタブへ移動（左方向）。先頭で押下すると末尾にループ

#### 共通動作
- どちらのキーも循環選択をサポート（タブリストの端に到達すると反対側にループ）
- タブ切り替え時は選択インデックスを0にリセット（最初のアイテムを選択状態にする）
- タブ切り替え時も検索クエリは保持される

#### マウス操作との違い
- **Tabキー**: キーボードでの高速なタブ切り替え
- **タブクリック**: マウスでの直接的なタブ選択
- どちらも同じ結果（アクティブタブの変更）だが、操作方法が異なる

#### 関連設定
- **タブ表示設定**: `showDataFileTabs` - Tabキーによるタブ切り替えの有効/無効
- **タブ順序**: `tabOrder` - Tabキーでの循環順序

詳細は **[アプリケーション設定](../../manual/app-settings.md#タブ表示設定)** を参照してください。
