# 管理ウィンドウ仕様書

## 関連ドキュメント

- [画面一覧](./README.md) - 全画面構成の概要
- [メインウィンドウ仕様書](./main-window.md) - メイン画面の詳細な仕様
- [アプリケーション設定](../features/settings.md) - 設定機能の使い方
- [アイテム管理](../features/item-management.md) - 編集機能の詳細

## 1. 概要

管理ウィンドウは、QuickDashLauncherの設定変更とデータ編集を行う管理画面です。「基本設定」「アイテム管理」「その他」の3つのタブで構成され、アプリケーションの動作をカスタマイズできます。

**キーボードショートカット**:
- Ctrl+E: メインウィンドウから管理ウィンドウを開く/閉じる（トグル）
- Ctrl+S: 変更を保存（アイテム管理タブ）
- Delete: 選択行を削除（アイテム管理タブ）

### 主要機能
- **基本設定タブ**: ホットキー、ウィンドウサイズ、ウィンドウ表示位置、自動起動、バックアップ設定、タブ表示設定
- **アイテム管理タブ**: data.txtの直接編集、行の追加・削除・整列、ブックマークインポート
- **その他タブ**: ファイル管理、システム情報表示、ショートカット一覧
- **設定の即座反映**: すべての設定変更が自動保存され、メインウィンドウに即座に反映される
- **リアルタイムバリデーション**: ホットキーの有効性をリアルタイムチェック

## 2. 基本情報

| 項目 | 内容 |
|------|------|
| **ファイル名** | `src/renderer/AdminApp.tsx` |
| **コンポーネント名** | `AdminApp` |
| **表示条件** | Ctrl+E、設定メニューから「⚙️ 基本設定」または「✏️ アイテム管理」を選択 |
| **画面タイプ** | ウィンドウ |
| **親画面** | メインウィンドウ |

## 3. 画面項目一覧

| エリア | 項目名 | 内容・説明 | 表示条件 | 機能詳細 |
|--------|--------|------------|----------|----------|
| **ヘッダー** | タブボタン（⚙️ 基本設定） | 基本設定タブへの切り替え | 常時表示 | [4.1](#41-タブボタンをクリック) |
| **ヘッダー** | タブボタン（✏️ アイテム管理） | アイテム管理タブへの切り替え | 常時表示 | [4.1](#41-タブボタンをクリック) |
| **ヘッダー** | タブボタン（📊 その他） | その他タブへの切り替え | 常時表示 | [4.1](#41-タブボタンをクリック) |
| **基本設定** | ホットキー入力欄 | グローバルホットキーの設定 | 基本設定タブ | [4.2](#42-ホットキー入力欄でキー押下) |
| **基本設定** | ウィンドウサイズ設定 | 通常時とアイテム管理時のサイズ設定 | 基本設定タブ | [4.3](#43-ウィンドウサイズを変更) |
| **基本設定** | 自動起動チェックボックス | 起動時に自動実行の設定 | 基本設定タブ | [4.4](#44-自動起動チェックボックスを変更) |
| **基本設定** | バックアップ設定 | バックアップ機能の詳細設定 | 基本設定タブ | [4.5](#45-バックアップ設定を変更) |
| **基本設定** | ウィンドウ表示位置設定 | ウィンドウ表示位置の選択（中央/カーソル位置/固定） | 基本設定タブ | [4.7](#47-ウィンドウ表示位置を変更) |
| **基本設定** | タブ表示設定 | 複数タブの表示設定 | 基本設定タブ | [4.23](#423-タブ表示設定を変更) |
| **基本設定** | タブ管理テーブル | タブの追加・削除・タブ名設定・順序変更 | 基本設定タブ、タブ表示ON時 | [4.24](#424-タブ管理操作) |
| **基本設定** | リセットボタン | 設定をデフォルト値にリセット | 基本設定タブ | [4.6](#46-リセットボタンをクリック) |
| **アイテム管理** | タブ選択ドロップダウン | 編集対象のタブを選択 | アイテム管理タブ | [4.25](#425-タブ選択ドロップダウンを変更) |
| **アイテム管理** | ファイル選択ドロップダウン | 編集対象のファイルを選択（複数ファイルタブの場合のみ表示） | アイテム管理タブ、複数ファイルタブ選択時 | [4.26](#426-ファイル選択ドロップダウンを変更) |
| **アイテム管理** | 検索入力欄 | 行の内容を検索してフィルタリング | アイテム管理タブ | [4.9](#49-検索入力欄に文字入力アイテム管理) |
| **アイテム管理** | 検索クリアボタン（×） | 検索クエリをクリア | アイテム管理タブ、検索文字入力時 | [4.10](#410-検索クリアボタンをクリック) |
| **アイテム管理** | ブックマークインポートボタン | ブラウザのブックマークをインポート | アイテム管理タブ | [4.11](#411-ブックマークインポートボタンをクリック) |
| **アイテム管理** | 変更を保存ボタン | データファイルへの書き込み | アイテム管理タブ、変更あり時 | [4.12](#412-変更を保存ボタンをクリック) |
| **アイテム管理** | ➕ 行を追加ボタン | 新規行を先頭に追加 | アイテム管理タブ | [4.13](#413-行を追加ボタンをクリック) |
| **アイテム管理** | 🗑️ 選択行を削除ボタン | 選択中の行を削除 | アイテム管理タブ、行選択時 | [4.14](#414-選択行を削除ボタンをクリック) |
| **アイテム管理** | 🔤 整列・重複削除ボタン | 現在のタブ内で行を整列して重複を削除 | アイテム管理タブ | [4.15](#415-整列重複削除ボタンをクリック) |
| **アイテム管理** | 行一覧テーブル | データファイルの全行を表示・編集 | アイテム管理タブ | [4.16](#416-行の内容を直接編集) |
| **アイテム管理** | 行選択チェックボックス | 各行の選択状態を管理 | アイテム管理タブ | [4.17](#417-行選択チェックボックスをクリック) |
| **アイテム管理** | ✏️ 編集ボタン | RegisterModalで詳細編集 | アイテム管理タブ | [4.18](#418-編集ボタンをクリック) |
| **アイテム管理** | ステータスバー | 選択行数、合計行数、未保存状態の表示 | アイテム管理タブ | - |
| **その他** | 📁 設定フォルダを開くボタン | 設定フォルダをエクスプローラーで開く | その他タブ | [4.19](#419-設定フォルダを開くボタンをクリック) |
| **その他** | 📄 データファイルを開くボタン | data.txtをテキストエディタで開く | その他タブ | [4.20](#420-データファイルを開くボタンをクリック) |
| **その他** | アプリケーション情報 | バージョン、ライセンス情報を表示 | その他タブ | - |
| **その他** | 🔗 GitHubリポジトリボタン | GitHubリポジトリを開く | その他タブ | [4.23](#423-githubリポジトリボタンをクリック) |
| **その他** | ショートカット一覧 | 利用可能なキーボードショートカット | その他タブ | - |
| **その他** | 🚪 アプリケーションを終了ボタン | アプリケーションを終了 | その他タブ | [4.21](#421-アプリケーションを終了ボタンをクリック) |

## 4. アクション一覧

| No | アクション名 | トリガー | 主な処理内容 | 詳細 |
|----|------------|---------|------------|------|
| 4.1 | タブボタンをクリック | タブボタンクリック | タブ切り替え、未保存変更の確認 | [詳細](#41-タブボタンをクリック) |
| 4.2 | ホットキー入力欄でキー押下 | ホットキー入力欄でキー押下 | ホットキーの設定とバリデーション | [詳細](#42-ホットキー入力欄でキー押下) |
| 4.3 | ウィンドウサイズを変更 | 数値入力欄に入力 | ウィンドウサイズの変更 | [詳細](#43-ウィンドウサイズを変更) |
| 4.4 | 自動起動チェックボックスを変更 | チェックボックスクリック | 自動起動設定の変更（即座反映） | [詳細](#44-自動起動チェックボックスを変更) |
| 4.5 | バックアップ設定を変更 | チェックボックス・数値入力 | バックアップ設定の変更（即座反映） | [詳細](#45-バックアップ設定を変更) |
| 4.6 | リセットボタンをクリック | リセットボタンクリック | 設定をデフォルト値にリセット（即座反映） | [詳細](#46-リセットボタンをクリック) |
| 4.7 | ウィンドウ表示位置を変更 | ラジオボタン選択 | ウィンドウ表示位置の変更（即座反映） | [詳細](#47-ウィンドウ表示位置を変更) |
| 4.9 | 検索入力欄に文字入力（アイテム管理） | テキスト入力 | 行のフィルタリング | [詳細](#49-検索入力欄に文字入力アイテム管理) |
| 4.10 | 検索クリアボタンをクリック | クリアボタン（×）クリック | 検索クエリをクリア | [詳細](#410-検索クリアボタンをクリック) |
| 4.11 | ブックマークインポートボタンをクリック | ボタンクリック | ブックマークインポートモーダルを開く | [詳細](#411-ブックマークインポートボタンをクリック) |
| 4.12 | 変更を保存ボタンをクリック | 保存ボタンクリック / Ctrl+S | データファイルに書き込み | [詳細](#412-変更を保存ボタンをクリック) |
| 4.13 | 行を追加ボタンをクリック | ボタンクリック | 新規空行を先頭に追加 | [詳細](#413-行を追加ボタンをクリック) |
| 4.14 | 選択行を削除ボタンをクリック | ボタンクリック / Deleteキー | 選択中の行を削除 | [詳細](#414-選択行を削除ボタンをクリック) |
| 4.15 | 整列・重複削除ボタンをクリック | ボタンクリック | 行を整列して重複を削除 | [詳細](#415-整列重複削除ボタンをクリック) |
| 4.16 | 行の内容を直接編集 | テーブルセル編集 | 行の内容を変更 | [詳細](#416-行の内容を直接編集) |
| 4.17 | 行選択チェックボックスをクリック | チェックボックスクリック | 行の選択状態を変更 | [詳細](#417-行選択チェックボックスをクリック) |
| 4.18 | 編集ボタンをクリック | ✏️ボタンクリック | RegisterModalで詳細編集 | [詳細](#418-編集ボタンをクリック) |
| 4.19 | 設定フォルダを開くボタンをクリック | ボタンクリック | エクスプローラーで設定フォルダを開く | [詳細](#419-設定フォルダを開くボタンをクリック) |
| 4.20 | データファイルを開くボタンをクリック | ボタンクリック | data.txtをテキストエディタで開く | [詳細](#420-データファイルを開くボタンをクリック) |
| 4.21 | アプリケーションを終了ボタンをクリック | ボタンクリック | アプリケーションを終了 | [詳細](#421-アプリケーションを終了ボタンをクリック) |
| 4.22 | GitHubリポジトリボタンをクリック | ボタンクリック | ブラウザでGitHubリポジトリを開く | [詳細](#422-githubリポジトリボタンをクリック) |
| 4.23 | タブ表示設定を変更 | チェックボックスクリック | タブ表示のON/OFFを切り替え | [詳細](#423-タブ表示設定を変更) |
| 4.24 | タブ管理操作 | ボタンクリック・テキスト入力 | タブの追加・削除・タブ名設定・順序変更 | [詳細](#424-タブ管理操作) |
| 4.25 | タブ選択ドロップダウンを変更 | ドロップダウン選択 | 編集対象のタブを切り替え | [詳細](#425-タブ選択ドロップダウンを変更) |
| 4.26 | ファイル選択ドロップダウンを変更 | ドロップダウン選択 | 編集対象のファイルを切り替え（複数ファイルタブの場合のみ） | [詳細](#426-ファイル選択ドロップダウンを変更) |
| 4.27 | ウィンドウを閉じる操作 | ウィンドウ閉じるボタン / Ctrl+E | 未保存変更の確認後、ウィンドウを閉じる | [詳細](#427-ウィンドウを閉じる操作) |

## 5. 機能詳細

### 4.1. タブボタンをクリック

#### アクション
- ヘッダーのタブボタン（⚙️ 基本設定、✏️ アイテム管理、📊 その他）をクリック

#### 処理フロー
1. 未保存の変更があるかチェック（アイテム管理タブのみ）
2. アイテム管理タブに未保存の変更がある場合：
   - 確認ダイアログを表示：「未保存の変更があります。タブを切り替えますか？」
   - OKの場合：未保存変更フラグをクリアしてタブを切り替え
   - キャンセルの場合：タブ切り替えを中止
3. 未保存の変更がない場合：
   - タブを切り替え
4. 選択されたタブのコンテンツを表示

#### タブ内容
- **⚙️ 基本設定**: SettingsTabコンポーネントを表示（即座反映モード）
- **✏️ アイテム管理**: EditModeViewコンポーネントを表示（保存ボタンあり）
- **📊 その他**: AdminOtherTabコンポーネントを表示

#### 注意
**v1.0.0以降**: 基本設定タブでは未保存変更の警告は不要です（すべての変更が自動保存されるため）。

### 4.2. ホットキー入力欄でキー押下

#### アクション
- ホットキー入力欄をクリックして、キーを押下

#### 処理フロー
1. ユーザーがキーを押下（例：Ctrl+Alt+Q）
2. HotkeyInputコンポーネントがキー組み合わせを検出
3. リアルタイムでバリデーションを実行：
   - 修飾キー（Ctrl、Alt、Shift）が含まれているか
   - 有効なキーの組み合わせか
4. バリデーション結果を表示：
   - 有効な場合：入力欄に表示
   - 無効な場合：エラーメッセージを表示
5. **即座保存**: バリデーション成功時、設定が自動的に保存され、`settings-changed`イベントが送信される

#### バリデーション条件
- 最低1つの修飾キー（Ctrl、Alt、Shift）が必要
- 単体のキーのみは不可
- Electronがサポートするキー組み合わせであること

#### 表示例
- **有効**: `Ctrl+Alt+Q`、`Ctrl+Shift+L`、`Alt+F1`
- **無効**: `Q`（修飾キーなし）、`Ctrl+Ctrl`（無効な組み合わせ）

### 4.3. ウィンドウサイズを変更

#### アクション
- ウィンドウサイズの数値入力欄に値を入力

#### 処理フロー
1. 入力値を取得
2. 範囲チェック：
   - 通常時の幅: 400-2000px
   - 通常時の高さ: 300-1200px
   - アイテム管理時の幅: 800-2000px
   - アイテム管理時の高さ: 600-1200px
3. **即座保存**: 設定が自動的に保存され、`settings-changed`イベントが送信される

#### 設定項目
- **windowWidth**: 通常時の幅
- **windowHeight**: 通常時の高さ
- **editModeWidth**: アイテム管理時の幅
- **editModeHeight**: アイテム管理時の高さ

### 4.4. 自動起動チェックボックスを変更

#### アクション
- 「起動時に自動実行」チェックボックスをクリック

#### 処理フロー
1. チェック状態を反転
2. **即座保存**: 設定が自動的に保存され、メインウィンドウに反映される
3. システム登録処理を実行（Windowsログイン時の自動起動を設定/解除）

#### 動作
- **有効**: Windowsログイン時にアプリケーションが自動起動
  - NSISインストーラー版: `Update.exe`経由で起動
  - ポータブル版: 実行ファイルを直接起動
  - Windowsレジストリに登録される
- **無効**: 手動で起動する必要がある
  - Windowsレジストリから登録解除される

#### システム登録の詳細
- **登録先**: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`
- **実装**: Electron標準API `app.setLoginItemSettings()`を使用
- **開発環境**: パッケージ化されていないため、設定は保存されますが実際の登録はスキップされます

#### 確認方法
- Windowsのタスクマネージャー → スタートアップタブで登録状態を確認できます
- 設定が正しく反映されているか確認する際に便利です

### 4.5. バックアップ設定を変更

#### アクション
- バックアップ関連のチェックボックス、または数値入力欄を変更

#### 処理フロー
1. 変更された項目の値を取得
2. **即座保存**: 設定が自動的に保存され、`settings-changed`イベントが送信される

#### 設定項目
- **backupEnabled**: バックアップ機能全体のON/OFF
- **backupOnStart**: アプリ起動時にバックアップを作成
- **backupOnEdit**: データ編集時にバックアップを作成
- **backupInterval**: 最小バックアップ間隔（1-60分）
- **backupRetention**: バックアップ保存件数（1-100件）

#### 表示条件
- `backupEnabled`が無効の場合、他のバックアップ設定は非表示

### 4.6. リセットボタンをクリック

#### アクション
- 「リセット」ボタンをクリック

#### 処理フロー
1. 確認ダイアログを表示：「設定をデフォルト値にリセットしますか？」
2. OKの場合：
   - 設定をデフォルト値にリセット
   - 全ウィンドウに反映
   - 画面表示を更新
3. キャンセルの場合：処理を中止

#### エラーハンドリング
- リセット失敗時：「設定のリセットに失敗しました。」というアラートを表示

#### 注意
**v1.0.0以降**: リセット処理も即座に反映され、「保存」ボタンは不要です。

### 4.7. ウィンドウ表示位置を変更

#### アクション
- ウィンドウ表示位置のラジオボタンを選択

#### 処理フロー
1. 選択した表示位置モードを取得
2. **即座保存**: 設定が自動的に保存され、メインウィンドウに反映される

#### 設定項目
- **windowPositionMode**: ウィンドウ表示位置モード

#### 選択肢
| モード | 説明 |
|--------|------|
| **center** | 画面中央 - 常に画面の中央にウィンドウを表示 |
| **cursor** | マウスカーソルの位置 - マウスカーソルの近くにウィンドウを表示 |
| **fixed** | 固定位置 - 手動で移動した位置を記憶して、次回も同じ位置に表示 |

#### 注意
- デフォルトは「center」（画面中央）
- 「fixed」モードでは、ウィンドウを手動で移動した後の位置が記憶されます

### 4.9. 検索入力欄に文字入力（アイテム管理）

#### アクション
- アイテム管理タブの検索入力欄に文字を入力

#### 処理フロー
1. 入力値を取得
2. 入力値をスペースで分割してキーワード配列を作成
3. 各行の内容をキーワードでフィルタリング：
   - すべてのキーワードが含まれる行のみ表示
   - 大文字小文字を区別しない
4. フィルタリング結果を表示
5. 非表示になった行の選択状態をクリア

#### 検索例
- 入力: `chrome google` → "chrome" AND "google"を含む行のみ表示
- 入力: `data.txt` → "data.txt"を含む行のみ表示

### 4.10. 検索クリアボタンをクリック

#### アクション
- 検索入力欄の「×」ボタンをクリック

#### 処理フロー
1. 検索クエリをクリア
2. すべての行を表示

#### 表示条件
- 検索文字が入力されている時のみ「×」ボタンを表示

### 4.11. ブックマークインポートボタンをクリック

#### アクション
- 「ブックマークをインポート」ボタンをクリック

#### 処理フロー
1. BookmarkImportModalを開く
2. ユーザーがブックマークを選択してインポート
3. インポートされたブックマークを新規行として追加：
   - 各ブックマークを `名前,URL` 形式に変換
   - 先頭に追加
4. 行番号を振り直し
5. 未保存変更フラグをセット
6. モーダルを閉じる

#### 関連ドキュメント
- [ブックマークインポートモーダル仕様書](./bookmark-import-modal.md)

### 4.12. 変更を保存ボタンをクリック

#### アクション
- 「変更を保存」ボタンをクリック、またはCtrl+Sキーを押下

#### 処理フロー
1. 編集内容を反映
2. 行番号を振り直し：
   - ファイル別にグループ化
   - 各ファイル内で1から連番を振り直し
3. データファイルに書き込み
4. 保存成功時：
   - 編集状態をクリア
   - 未保存変更フラグをクリア
5. メインウィンドウにデータ変更を通知
6. データを再読み込み

#### エラーハンドリング
- 保存失敗時：コンソールにエラーを出力

#### 表示条件
- 未保存の変更がある場合のみ有効

### 4.13. 行を追加ボタンをクリック

#### アクション
- 「➕ 行を追加」ボタンをクリック

#### 処理フロー
1. 空行を作成：
   - lineNumber: 1
   - content: ''
   - type: 'empty'
   - sourceFile: 'data.txt'
2. 先頭に追加
3. 行番号を振り直し
4. 未保存変更フラグをセット

### 4.14. 選択行を削除ボタンをクリック

#### アクション
- 「🗑️ 選択行を削除」ボタンをクリック、またはDeleteキーを押下

#### 処理フロー
1. 選択中の行を取得
2. 確認ダイアログを表示：「{N}行を削除しますか？」
3. OKの場合：
   - 選択行をworkingLinesから削除
   - 行番号を振り直し
   - 選択状態をクリア
   - 未保存変更フラグをセット
4. キャンセルの場合：処理を中止

#### 表示条件
- 行が選択されている場合のみ有効
- ボタンには選択行数を表示（例：「選択行を削除 (3)」）

### 4.15. 整列・重複削除ボタンをクリック

#### アクション
- 「🔤 整列・重複削除（{タブ名}タブのみ）」ボタンをクリック

#### 処理フロー
1. **現在選択中のタブのみ**を対象に行を整列：
   - **第1ソート**: 行タイプ（directive → item → comment → empty）
   - **第2ソート**: パスと引数（アルファベット順）
   - **第3ソート**: 名前（アルファベット順、アイテム行のみ）
2. 重複行を検出（現在のタブ内のみ）：
   - 行タイプと内容が完全一致する行を重複と判定
3. 重複がある場合：
   - 確認ダイアログを表示：「整列処理が完了しました（対象: {タブ名}タブ）。\n\n{N}件の重複行が見つかりました。\n重複行を削除しますか？」
   - OKの場合：重複行を削除した結果を適用
   - キャンセルの場合：重複行を削除せず整列のみ適用
4. 重複がない場合：
   - 整列結果をそのまま適用
5. 未保存変更フラグをセット

#### 注意
- **他のタブのデータには影響しません**。整列・重複削除は現在表示中のタブ内のアイテムにのみ適用されます。

#### 整列例
```
[変更前]
Google,https://google.com
# コメント
dir,C:\Projects

[変更後]
dir,C:\Projects
Google,https://google.com
# コメント
```

### 4.16. 行の内容を直接編集

#### アクション
- 行一覧テーブルのセルを編集

#### 処理フロー
1. セルの内容を編集
2. 編集内容をeditedLinesに記録
3. 未保存変更フラグをセット

#### 編集可能な項目
- 行の内容（content）
- 行全体を直接テキスト編集

### 4.17. 行選択チェックボックスをクリック

#### アクション
- 各行のチェックボックスをクリック、またはヘッダーの全選択チェックボックスをクリック

#### 処理フロー

**個別行のチェックボックス:**
1. チェック状態を取得
2. 行キー（`{sourceFile}_{lineNumber}`）を作成
3. selectedItemsに追加/削除
4. 選択行数を更新

**ヘッダーの全選択チェックボックス:**
1. チェック状態を取得
2. チェックON時：表示中のすべての行を選択
3. チェックOFF時：すべての選択を解除
4. 選択行数を更新

#### 表示
- ステータスバーに選択行数を表示（例：「3行を選択中」）

### 4.18. 編集ボタンをクリック

#### アクション
- 行の「✏️ 編集」ボタンをクリック

#### 処理フロー
1. 編集対象の行を取得
2. 登録・編集モーダルを開く
3. 設定からタブ情報を読み込み、保存先選択肢を構築
4. 行の内容を編集用フォーマットに変換してモーダルに渡す
5. ユーザーがモーダルで編集（保存先タブの変更も可能）
6. 保存時：
   - 編集内容を行データに変換
   - 編集済み行として記録
   - 未保存変更フラグをセット
7. モーダルを閉じる

#### 保存先タブの変更
管理ウィンドウの編集モーダルでは、保存先タブを変更することはできますが、実際の変更は保存ボタンをクリックするまで確定されません。

**注意**: 管理ウィンドウでは、メインウィンドウと異なり、タブ間のアイテム移動は自動的には行われません。保存先を変更する場合は、以下のいずれかの方法を使用してください：
- メインウィンドウの右クリックメニューから「✏️ 編集」を選択（保存先変更で自動的にタブ間移動）
- 管理ウィンドウで編集後、手動で元のファイルから削除して新しいファイルに追加

#### 編集用フォーマットへの変換
- **アイテム行**: 名前、パス、引数、カスタムアイコンに分割
- **フォルダ取込**: フォルダパスとオプションに分割
- **グループ**: グループ名と含まれるアイテムに分割

### 4.19. 設定フォルダを開くボタンをクリック

#### アクション
- 「📁 設定フォルダを開く」ボタンをクリック

#### 処理フロー
1. エクスプローラーで設定フォルダを開く

#### 対象フォルダ
- `%APPDATA%/quick-dash-launcher/config/`

### 4.20. データファイルを開くボタンをクリック

#### アクション
- 「📄 データファイルを開く」ボタンをクリック

#### 処理フロー
1. デフォルトのテキストエディタでdata.txtを開く

#### 対象ファイル
- `%APPDATA%/quick-dash-launcher/config/data.txt`

### 4.21. アプリケーションを終了ボタンをクリック

#### アクション
- 「🚪 アプリケーションを終了」ボタンをクリック

#### 処理フロー
1. 確認ダイアログを表示：「アプリケーションを終了しますか？」
2. OKの場合：アプリケーションを終了
3. キャンセルの場合：処理を中止

### 4.22. GitHubリポジトリボタンをクリック

#### アクション
- 「🔗 GitHubリポジトリ」ボタンをクリック

#### 処理フロー
1. デフォルトブラウザでGitHubリポジトリページを開く

#### 対象URL
- `https://github.com/masaodev/quick-dash-launcher`

#### 表示条件
- アプリケーション情報の読み込みが完了するまでボタンは無効化

### 4.23. タブ表示設定を変更

#### アクション
- 「複数タブを表示」チェックボックスをクリック

#### 処理フロー
1. チェックボックスの状態を切り替え
2. **即座保存**: 設定が自動的に保存され、メインウィンドウに反映される
3. チェックON時：タブ管理テーブルとデフォルトタブの設定項目が表示される
4. チェックOFF時：タブ管理テーブルとデフォルトタブの設定項目が非表示になる

#### 設定の反映
- 設定が即座に保存され、メインウィンドウがある場合は自動的に反映される
- メインウィンドウにタブバーが表示/非表示される

#### UI変更の履歴
- **v1.0.0以降**: チェックボックスのラベルが「複数データファイルをタブで表示」から「複数タブを表示」に変更されました
- **v1.0.0以降**: セクション名が「データファイル管理」から「タブ管理」に変更されました

### 4.24. タブ管理操作

#### アクション
タブ管理テーブルでの各種操作（v1.0.0以降、セクション名が「データファイル管理」から「タブ管理」に変更）

#### 操作種別

##### ➕ 新規タブを追加ボタンをクリック
1. 次のファイル番号を自動決定（例: data2.txt, data3.txt...）
2. 新規データファイルを作成
3. ファイル作成成功時：
   - 物理ファイル（data2.txt等）が作成される
   - 設定のタブ情報に新しいエントリが自動的に追加される
   - テーブルに新しい行が追加表示される
4. ファイル作成失敗時：
   - エラーメッセージをアラート表示

##### タブ名を入力・変更
1. 各タブのタブ名入力欄にテキストを入力
2. タブ情報を更新
3. **即座保存**: 設定が自動的に保存され、メインウィンドウに反映される
4. メインウィンドウとアイテム管理画面のタブ名/ドロップダウンがリアルタイムに更新される

##### デフォルトタブ名
タブ名が未設定の場合、わかりやすいデフォルト名が表示されます：
- `data.txt` → 「メイン」
- `data2.txt` → 「サブ1」
- `data3.txt` → 「サブ2」
- `data4.txt` → 「サブ3」（以降同様）

**v1.0.0以降**: アイテム管理画面の「タブ名:」ドロップダウンでも、これらのデフォルトタブ名が表示されます（ファイル名は省略）

##### 🗑️削除ボタンをクリック
1. data.txtを含むタブの場合：アラート表示「data.txtを含むタブは削除できません。」
2. その他のタブの場合：
   - 確認ダイアログ表示：「タブ「{tabName}」を削除しますか？\nこのタブに含まれる全てのファイルも削除されます。」
   - OKの場合：
     - タブに含まれる全ファイルを削除
     - 設定からタブ情報を削除
     - 更新された設定を保存
   - 削除成功時：テーブルが更新される
   - 削除失敗時：エラーメッセージをアラート表示

##### 📁ファイル管理ボタンをクリック
タブに関連付けるファイルを管理するモーダルを開きます。

**モーダルの機能:**
- **関連ファイル一覧**: タブに含まれるファイルのリストを表示
- **ファイル削除**: 各ファイルの「削除」ボタンでタブからファイルを削除（物理ファイルも削除、最低1ファイルは必要）
- **既存ファイルを追加**: ドロップダウンから他のタブにないファイルを選択して追加
- **新規ファイルを作成して追加**: 新しいファイルを作成してタブに追加

##### 📁フォルダを開くボタンをクリック
1. エクスプローラーで設定フォルダを開く
2. データファイルを直接確認・編集可能

#### テーブル構成
- **順序列**:
  - ▲ボタン: タブを上に移動（最上位の行では無効化）
  - ▼ボタン: タブを下に移動（最下位の行では無効化）
- **タブ名列**: 入力可能なテキストフィールド、プレースホルダーは「タブ N」形式
- **削除列**: 🗑️ 削除ボタン（data.txtを含むタブでは非表示）
- **ファイル管理列**: 📁 (N個) ボタン - クリックでファイル管理モーダルを開く

#### 表示条件
- タブ表示がONの場合のみ表示される
- タブ表示がOFFの場合は非表示

#### 重要な仕様変更

**v1.0.0以降**: タブ表示は設定ファイルベースで動作します：

- **変更前**: 物理ファイル（data.txt, data2.txt等）の存在をベースにタブ表示
- **変更後**: 設定ファイル（settings.json）のタブ情報をベースにタブ表示
- **自動作成**: タブ情報に登録されているが物理ファイルが存在しない場合は、自動的にファイルを作成
- **削除時の挙動**: ファイル削除時は、物理ファイルとタブ情報の両方から削除
- **順序管理**: タブ情報の順序がそのままタブ表示順序

### 4.25. タブ選択ドロップダウンを変更

#### アクション
- アイテム管理タブのヘッダーにある「タブ:」ドロップダウンを変更

#### 処理フロー
1. ドロップダウンから編集したいタブを選択
2. 未保存の変更がある場合：
   - 確認ダイアログ表示：「未保存の変更があります。タブを切り替えると変更が失われます。続行しますか？」
   - OKの場合：処理を継続
   - キャンセルの場合：処理を中止、元のタブのまま
3. 選択したタブの最初のファイル（files[0]）が自動的に選択される
4. 選択したファイルの内容をテーブルに表示

#### 利用可能なタブ
- 設定に登録されているタブのみが選択肢に表示されます
- tempdata.txtは除外（自動生成ファイルのため）

#### 初期選択
- アイテム管理タブを開いた際は、最初のタブが初期選択される

#### ドロップダウン表示
- **ラベル**: 「タブ:」
- **表示形式**: タブ名を表示
  - **カスタムタブ名が設定されている場合**: タブ名のみ表示（例: `仕事用`、`プライベート`）
  - **カスタムタブ名がない場合**: デフォルトタブ名を表示（例: `メイン`、`サブ1`、`サブ2`）
- **表示例**:
  - data.txt（タブ名「仕事用」設定時） → `仕事用`
  - data2.txt（タブ名「プライベート」設定時） → `プライベート`
  - data3.txt（タブ名未設定時） → `サブ2`（デフォルトタブ名）

#### UI構成
- **単一ファイルタブの場合**: タブ選択ドロップダウンのみ表示
- **複数ファイルタブの場合**: タブ選択 + ファイル選択の2段階ドロップダウンを表示

### 4.26. ファイル選択ドロップダウンを変更

#### アクション
- アイテム管理タブのヘッダーにある「ファイル:」ドロップダウンを変更（複数ファイルタブの場合のみ表示）

#### 処理フロー
1. ドロップダウンから編集したいファイルを選択
2. 未保存の変更がある場合：
   - 確認ダイアログ表示：「未保存の変更があります。ファイルを切り替えると変更が失われます。続行しますか？」
   - OKの場合：処理を継続
   - キャンセルの場合：処理を中止、元のファイルのまま
3. 選択したファイルの内容をテーブルに表示

#### 表示条件
- 現在選択されているタブが複数のファイルを持つ場合のみ表示されます
- 単一ファイルのタブの場合は、このドロップダウンは表示されません

#### ドロップダウン表示
- **ラベル**: 「ファイル:」
- **選択肢**: 現在のタブに属する全てのファイル名（例: `data.txt`、`data2.txt`）

#### 自動選択
- タブ変更時に、そのタブの最初のファイル（files[0]）が自動的に選択されます

### 4.27. ウィンドウを閉じる操作

#### アクション
- ウィンドウの閉じるボタン（×）をクリック、またはCtrl+Eキーを押下

#### 処理フロー
1. 未保存の変更があるかチェック（アイテム管理タブのみ）
2. 未保存の変更がある場合：
   - 確認ダイアログを表示：「未保存の変更があります。アイテム管理を終了しますか？」
   - OKの場合：ウィンドウを閉じる
   - キャンセルの場合：処理を中止
3. 未保存の変更がない場合：ウィンドウを閉じる

#### 管理ウィンドウを閉じる方法

**ウィンドウ右上の閉じるボタン（×）:**
- すべてのタブで使用可能
- 未保存変更がある場合は確認ダイアログが表示される

**Ctrl+Eキー:**
- メインウィンドウから管理ウィンドウを開く/閉じるトグル操作
- 未保存変更がある場合は確認ダイアログが表示される

**設定メニューから「閉じる」:**
- 設定メニュー（⚙）から管理ウィンドウを閉じることも可能
- 未保存変更がある場合は確認ダイアログが表示される

#### Escapeキーについて

**重要**: 管理ウィンドウでは、Escapeキーでウィンドウを閉じる機能は**無効化されています**。

**理由:**
- アイテム管理中の誤操作防止
- 編集作業中に誤ってEscapeキーを押してウィンドウが閉じるのを防ぐ
- テキスト編集中のキャンセル操作との混同を防ぐ

**代替方法:**
- 上記の3つの方法（閉じるボタン、Ctrl+E、設定メニュー）のいずれかを使用してください

#### 未保存変更の扱い

**確認ダイアログの条件:**
- アイテム管理タブで編集内容が保存されていない場合のみ表示される
- 基本設定タブとその他タブでは、すべての変更が自動保存されるため確認ダイアログは表示されない

**確認ダイアログの動作:**
- OKを選択：未保存の変更を破棄してウィンドウを閉じる
- キャンセルを選択：ウィンドウを閉じずに編集を継続する
