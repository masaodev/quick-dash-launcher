# グループ起動機能

複数のアイテムをまとめて一括起動する「グループ」機能の詳細説明です。

## 概要

グループ機能を使うと、複数のアプリケーション、Webサイト、フォルダ、ファイルを1つのグループとして定義し、一度の操作でまとめて起動できます。

### 主な特徴

- **参照ベース設計**: グループは既存アイテムの名前を参照するため、アイテム情報の重複がありません
- **順次実行**: グループ内のアイテムは定義順に起動されます（500msの間隔）
- **DRY原則**: アイテムのパスや設定はすべて個別定義で管理され、グループは名前のみを参照
- **柔軟な組み合わせ**: あらゆるタイプのアイテム（URL、アプリ、フォルダ、ファイル、カスタムURI）を組み合わせ可能

## 使用例

### 基本的な使用例

```
// 個別アイテムの定義
Visual Studio Code,code.exe
Slack,slack://
Chrome,chrome.exe,--new-window https://localhost:3000
開発フォルダ,C:\dev

// グループ定義
group,開発環境,Visual Studio Code,Slack,Chrome,開発フォルダ
```

この例では、「開発環境」グループを実行すると：
1. Visual Studio Codeが起動
2. 500ms待機
3. Slackが起動
4. 500ms待機
5. Chromeが起動（localhost:3000を開く）
6. 500ms待機
7. 開発フォルダが開く

### 複数のグループを定義する例

```
// アイテム定義
Zoom,zoom://
Teams,teams://
議事録フォルダ,C:\meetings
Google,https://google.com
GitHub,https://github.com
Gmail,https://mail.google.com

// グループ定義
group,会議準備,Zoom,Teams,議事録フォルダ
group,Web閲覧,Google,GitHub,Gmail
```

### 実際のユースケース

**プロジェクトごとの起動設定:**
```
// プロジェクトAの環境
VSCode ProjectA,code.exe,--new-window C:\Projects\ProjectA
Chrome ProjectA,chrome.exe,https://projecta.local
ProjectA Folder,C:\Projects\ProjectA

group,ProjectA起動,VSCode ProjectA,Chrome ProjectA,ProjectA Folder
```

**業務開始時の一括起動:**
```
// 業務ツール
Outlook,outlook://
Teams,teams://
社内ポータル,https://portal.company.com
タイムカード,https://timecard.company.com

group,業務開始,Outlook,Teams,社内ポータル,タイムカード
```

## データファイル形式

### 基本構文

```
group,グループ名,アイテム名1,アイテム名2,アイテム名3,...
```

### フィールド構成

| フィールド | 位置 | 必須 | 説明 |
|------------|------|------|------|
| **グループ名** | 1 | ✓ | グループの表示名 |
| **アイテム名1〜N** | 2〜 | ✓ | 既存アイテムの名前（参照） |

### 重要な仕様

1. **参照解決**: グループ内のアイテム名は、データファイル内の既存アイテム名を参照します
2. **順次実行**: グループ実行時、リストされたアイテムを順番に起動します
3. **実行間隔**: 各アイテムの起動間隔は500ms（固定）です
4. **エラー処理**: 存在しないアイテム名は警告ログを出力してスキップします
5. **循環参照不可**: グループ内でグループは参照できません（LauncherItemのみ）

## UI表示

### メインウィンドウでの表示

グループアイテムは、アイテムリストに以下のように表示されます：

- **アイコン**: 📦（固定）
- **背景色**: 水色系（他のアイテムと視覚的に区別）
- **左境界線**: 青色の強調線
- **表示名**: `グループ名 (N個)`
  - 例: `開発環境 (4個)`
- **ツールチップ**: `グループ: アイテム名1, アイテム名2, ...`

### 実行方法

1. **検索してEnter**: 検索ボックスにグループ名を入力してEnterキー
2. **矢印キーで選択してEnter**: ↑↓キーで選択してEnterキー
3. **クリック**: マウスでグループアイテムをクリック

## アイテム管理での編集

アイテム管理画面（Ctrl+E）でグループを作成・編集できます。

### 新規グループの作成

1. **行を追加**: ➕行を追加ボタンをクリック
2. **種類選択**: 空行の「種類」列で📦グループボタンをクリック
3. **セル編集**: 各セルをクリックして編集
   - **名前**: グループ名を入力
   - **パスと引数**: アイテム名をカンマ区切りで入力（例: `Chrome, Slack, VSCode`）
4. **保存**: 保存ボタン（または Ctrl+S）で確定

### 詳細編集モーダルでの編集

✏️ボタンをクリックするとRegisterModalが開き、より詳細な編集ができます：

1. **種別選択**: 「グループ」を選択
2. **グループ名**: グループの表示名を入力
3. **アイテム名リスト**: 既存のアイテム名をカンマ区切りで入力
   - 自由にカンマを入力できます
   - 複数行に分けて入力することも可能
   - 例: `Visual Studio Code, Slack, Chrome`
4. **保存先**: メインタブまたは一時タブを選択
5. **更新**: 更新ボタンで確定

### 既存グループの編集

1. グループ行の✏️ボタンをクリック
2. RegisterModalで内容を編集
3. 更新ボタンで確定

### グループの削除

1. グループ行のチェックボックスを選択
2. 🗑️選択行を削除ボタンをクリック
3. 確認ダイアログでOK

## エラーハンドリング

### 存在しないアイテム名を参照している場合

```
Visual Studio Code,code.exe
Slack,slack://

// 存在しないアイテム "Chrome" を参照
group,開発環境,Visual Studio Code,Slack,Chrome
```

**動作:**
- Visual Studio Codeが起動
- Slackが起動
- "Chrome"は存在しないため、警告ログを出力してスキップ
- グループ実行は継続（エラーで停止しない）

**警告ログ例:**
```
[WARN] Group item not found: Chrome
```

### 部分的なエラー

グループ内の一部のアイテムが存在しない場合でも、残りのアイテムは正常に起動されます。

## 設計上の利点

### DRY原則（Don't Repeat Yourself）

グループは参照ベース設計のため、アイテム情報の重複がありません：

**❌ 悪い例（重複あり）:**
```
Visual Studio Code,code.exe
開発環境,code.exe,slack://,chrome.exe  # 情報が重複
```

**✅ 良い例（参照ベース）:**
```
Visual Studio Code,code.exe
Slack,slack://
Chrome,chrome.exe

group,開発環境,Visual Studio Code,Slack,Chrome
```

### 保守性

アイテムのパス変更時は個別定義のみ修正すればOK：

```
// VS Codeのパスが変更された場合
Visual Studio Code,C:\New\Path\Code.exe  # ← ここだけ修正

// グループ定義は変更不要
group,開発環境,Visual Studio Code,Slack,Chrome
```

### 可読性

グループ定義が非常に簡潔で、何を起動するかが一目でわかります：

```
group,朝の業務開始,Outlook,Teams,社内ポータル,タイムカード
```

### 一貫性

グループで起動するアイテムは、個別に起動した場合と完全に同じ動作を保証します。

## 制限事項

### 現在の制限

1. **起動間隔固定**: 各アイテムの起動間隔は500ms固定（カスタマイズ不可）
2. **グループのネスト不可**: グループ内でグループは参照できません
3. **コンテキストメニュー非対応**: 現在、グループアイテムは右クリックメニューが無効です
4. **カスタムアイコン非対応**: グループアイテムのアイコンは📦固定です

### 将来の拡張予定

- グループ実行時の起動間隔のカスタマイズ
- グループ専用コンテキストメニュー
- グループ内容のプレビュー機能強化
- グループ整合性チェック機能

## ベストプラクティス

### 1. 意味のあるグループ名をつける

**❌ 悪い例:**
```
group,group1,Chrome,Slack,VSCode
```

**✅ 良い例:**
```
group,開発環境,Chrome,Slack,VSCode
```

### 2. 起動順序を考慮する

重いアプリケーションを先に起動し、軽いアプリや特定のURLを後に起動することで、スムーズな起動体験を実現：

```
// 重い→軽い の順
group,開発環境,Visual Studio Code,Docker Desktop,Chrome,Slack
```

### 3. 用途別にグループを分ける

1つの大きなグループより、用途別に小さなグループを作成した方が柔軟：

**❌ 悪い例:**
```
group,全部,App1,App2,App3,App4,App5,App6,App7,App8
```

**✅ 良い例:**
```
group,開発環境,VSCode,Docker,Chrome
group,コミュニケーション,Teams,Slack,Zoom
group,業務ツール,Outlook,社内ポータル,タイムカード
```

### 4. グループ名は検索しやすくする

グループを素早く起動できるよう、短く検索しやすい名前にする：

**❌ 悪い例:**
```
group,毎朝の業務開始時に使用する一連のアプリケーション群,Outlook,Teams
```

**✅ 良い例:**
```
group,朝の起動,Outlook,Teams
group,業務開始,Outlook,Teams  # さらに短く
```

## トラブルシューティング

### グループが実行されない

**原因1: グループ内のアイテム名が間違っている**
- data.txtを確認し、参照しているアイテム名が正確か確認
- 大文字小文字、スペースの有無に注意

**原因2: グループ構文が間違っている**
- `group,`で始まっているか確認
- カンマの区切りが正しいか確認

### 一部のアイテムだけ起動されない

**原因: 存在しないアイテム名を参照している**
- アイテム管理画面（Ctrl+E）でグループ行を確認
- ✏️ボタンで詳細編集し、アイテム名リストを修正

### グループアイテムが表示されない

**原因: data.txtの構文エラー**
- アイテム管理画面でグループ行が正しく認識されているか確認
- 行の種類が「グループ」と表示されているか確認

## 関連ドキュメント

- **[データファイル形式仕様](../reference/data-file-format.md)** - グループの詳細な構文仕様
- **[アイテム管理](item-management.md)** - グループ編集方法の詳細
- **[テストチェックリスト](../guides/testing.md)** - グループ機能のテスト項目
- **[開発ガイド](../guides/development.md)** - 実装詳細
