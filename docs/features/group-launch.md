# グループ起動機能

複数のアイテムをまとめて一括起動する「グループ」機能の詳細説明です。

## 概要

グループ機能を使うと、複数のアプリケーション、Webサイト、フォルダ、ファイルを1つのグループとして定義し、一度の操作でまとめて起動できます。

### 主な特徴

- **参照ベース設計**: グループは既存アイテムの名前を参照するため、アイテム情報の重複がありません
- **2つの起動モード**: 順次実行（デフォルト）または並列実行を選択可能
  - **順次実行**: 定義順に起動し、各アイテム間で100ms待機（起動順序が保証される）
  - **並列実行**: 全アイテムを同時に起動（高速だが順序は保証されない）
- **DRY原則**: アイテムのパスや設定はすべて個別定義で管理され、グループは名前のみを参照
- **柔軟な組み合わせ**: あらゆるタイプのアイテム（URL、アプリ、フォルダ、ファイル、カスタムURI、ウィンドウ操作）を組み合わせ可能

## 起動モードの設定

グループの起動モード（順次実行または並列実行）は、アプリケーション設定で変更できます。

### 設定方法

1. **管理画面を開く**: `Ctrl+E`
2. **設定タブを選択**: 画面上部のタブから「設定」を選択
3. **基本設定カテゴリ**: 左側メニューで「⚙️ 基本設定」を選択
4. **グループ起動セクション**: 「グループアイテムを並列起動」のチェックボックスを切り替え
5. **設定を保存**: リセットボタンで保存（自動保存）

### 起動モードの選び方

**順次実行（デフォルト）を選ぶべき場合:**
- アイテムの起動順序が重要な場合
- 一部のアイテムが他のアイテムに依存している場合
- システムリソースを節約したい場合

**並列実行を選ぶべき場合:**
- アイテムの起動順序が重要でない場合
- すべてのアイテムが独立している場合
- グループ起動を高速化したい場合

## 使用例

### 基本的な使用例

```
// 個別アイテムの定義
Visual Studio Code,code.exe
Slack,slack://
Chrome,chrome.exe,--new-window https://localhost:3000
開発フォルダ,C:\dev

// グループ定義
group,開発環境,Visual Studio Code,Slack,Chrome,開発フォルダ
```

この例では、「開発環境」グループを実行すると（順次起動モードの場合）：
1. Visual Studio Codeが起動
2. 100ms待機
3. Slackが起動
4. 100ms待機
5. Chromeが起動（localhost:3000を開く）
6. 100ms待機
7. 開発フォルダが開く

### 複数のグループを定義する例

```
// アイテム定義
Zoom,zoom://
Teams,teams://
議事録フォルダ,C:\meetings
Google,https://google.com
GitHub,https://github.com
Gmail,https://mail.google.com

// グループ定義
group,会議準備,Zoom,Teams,議事録フォルダ
group,Web閲覧,Google,GitHub,Gmail
```

### 実際のユースケース

**プロジェクトごとの起動設定:**
```
// プロジェクトAの環境
VSCode ProjectA,code.exe,--new-window C:\Projects\ProjectA
Chrome ProjectA,chrome.exe,https://projecta.local
ProjectA Folder,C:\Projects\ProjectA

group,ProjectA起動,VSCode ProjectA,Chrome ProjectA,ProjectA Folder
```

**業務開始時の一括起動:**
```
// 業務ツール
Outlook,outlook://
Teams,teams://
社内ポータル,https://portal.company.com
タイムカード,https://timecard.company.com

group,業務開始,Outlook,Teams,社内ポータル,タイムカード
```

## データファイル形式

グループアイテムの詳細な構文と動作仕様については、**[データファイル形式仕様 - グループアイテム行の詳細](../architecture/data-format.md#グループアイテム行の詳細)** を参照してください。

## UI表示

### メインウィンドウでの表示

グループアイテムは、アイテムリストに以下のように表示されます：

- **アイコン**: 📦（固定）
- **背景色**: 水色系（他のアイテムと視覚的に区別）
- **左境界線**: 青色の強調線
- **表示名**: `グループ名 (N個)`
  - 例: `開発環境 (4個)`
- **ツールチップ**: マウスホバーで詳細情報を表示
  - グループに含まれるアイテム名の一覧
  - データファイル名（data.json または data2.json）
  - データファイル内の行番号

### ツールチップの表示例

グループアイテムにマウスをホバーすると、以下のような情報が表示されます：

```
グループ: Visual Studio Code, Slack, Chrome, 開発フォルダ

データファイル: data.json
行番号: 25
```

### 実行方法

1. **検索してEnter**: 検索ボックスにグループ名を入力してEnterキー
2. **矢印キーで選択してEnter**: ↑↓キーで選択してEnterキー
3. **クリック**: マウスでグループアイテムをクリック

## アイテム管理での編集

アイテム管理画面（Ctrl+E）でグループを作成・編集できます。

### 新規グループの作成

1. **行を追加**: ➕行を追加ボタンをクリック
2. **種類選択**: 空行の「種類」列で📦グループボタンをクリック
3. **セル編集**: 各セルをクリックして編集
   - **名前**: グループ名を入力
   - **パスと引数**: アイテム名をカンマ区切りで入力（例: `Chrome, Slack, VSCode`）
4. **保存**: 保存ボタン（または Ctrl+S）で確定

### 詳細編集モーダルでの編集

✏️ボタンをクリックするとRegisterModalが開き、より詳細な編集ができます：

1. **種別選択**: 「グループ」を選択
2. **グループ名**: グループの表示名を入力
3. **アイテム名リスト**: 既存のアイテム名をカンマ区切りで入力
   - 自由にカンマを入力できます
   - 複数行に分けて入力することも可能
   - 例: `Visual Studio Code, Slack, Chrome`
4. **保存先**: メインタブまたは一時タブを選択
5. **更新**: 更新ボタンで確定

### 既存グループの編集

1. グループ行の✏️ボタンをクリック
2. RegisterModalで内容を編集
3. 更新ボタンで確定

### グループの削除

1. グループ行のチェックボックスを選択
2. 🗑️選択行を削除ボタンをクリック
3. 確認ダイアログでOK

## エラーハンドリング

### 存在しないアイテム名を参照している場合

```
Visual Studio Code,code.exe
Slack,slack://

// 存在しないアイテム "Chrome" を参照
group,開発環境,Visual Studio Code,Slack,Chrome
```

**動作:**
- Visual Studio Codeが起動
- Slackが起動
- "Chrome"は存在しないため、警告ログを出力してスキップ
- グループ実行は継続（エラーで停止しない）

**警告ログ例:**
```
[WARN] グループ内のアイテムが見つかりません { groupName: "開発環境", itemName: "Chrome" }
```

### 部分的なエラー

グループ内の一部のアイテムが存在しない場合でも、残りのアイテムは正常に起動されます。

## 設計上の利点

### DRY原則（Don't Repeat Yourself）

グループは参照ベース設計のため、アイテム情報の重複がありません：

**❌ 悪い例（重複あり）:**
```
Visual Studio Code,code.exe
開発環境,code.exe,slack://,chrome.exe  # 情報が重複
```

**✅ 良い例（参照ベース）:**
```
Visual Studio Code,code.exe
Slack,slack://
Chrome,chrome.exe

group,開発環境,Visual Studio Code,Slack,Chrome
```

### 保守性

アイテムのパス変更時は個別定義のみ修正すればOK：

```
// VS Codeのパスが変更された場合
Visual Studio Code,C:\New\Path\Code.exe  # ← ここだけ修正

// グループ定義は変更不要
group,開発環境,Visual Studio Code,Slack,Chrome
```

### 可読性

グループ定義が非常に簡潔で、何を起動するかが一目でわかります：

```
group,朝の業務開始,Outlook,Teams,社内ポータル,タイムカード
```

### 一貫性

グループで起動するアイテムは、個別に起動した場合と完全に同じ動作を保証します。

## コンテキストメニュー

グループアイテムを右クリックすると、編集用のコンテキストメニューが表示されます。

### メニュー項目

- **✏️ 編集**: グループ編集モーダルを開く

### 動作

- グループアイテムの場合、パス関連のメニュー項目（親フォルダーを開く、パスをコピー等）は非表示になります
- 編集メニューのみが表示され、グループの内容を変更できます

## 制限事項

### 現在の制限

1. **起動間隔固定**: 順次実行時の起動間隔は100ms固定（カスタマイズ不可）
2. **グループのネスト不可**: グループ内でグループは参照できません
3. **カスタムアイコン非対応**: グループアイテムのアイコンは📦固定です
4. **並列起動の順序**: 並列起動モードでは起動順序が保証されません

### 並列起動の注意事項

- **順序依存**: アイテム間に依存関係がある場合は順次実行を使用してください
- **リソース消費**: 多数のアイテムを並列起動すると、一時的にシステムリソースを多く消費します
- **ウィンドウ配置**: 複数のウィンドウを同時に開く場合、ウィンドウの重なり方が予測しづらくなります

### 将来の拡張予定

- グループごとの起動モード設定
- グループ専用コンテキストメニュー
- グループ内容のプレビュー機能強化
- グループ整合性チェック機能

## ベストプラクティス

### 1. 意味のあるグループ名をつける

**❌ 悪い例:**
```
group,group1,Chrome,Slack,VSCode
```

**✅ 良い例:**
```
group,開発環境,Chrome,Slack,VSCode
```

### 2. 起動順序を考慮する

重いアプリケーションを先に起動し、軽いアプリや特定のURLを後に起動することで、スムーズな起動体験を実現：

```
// 重い→軽い の順
group,開発環境,Visual Studio Code,Docker Desktop,Chrome,Slack
```

### 3. 用途別にグループを分ける

1つの大きなグループより、用途別に小さなグループを作成した方が柔軟：

**❌ 悪い例:**
```
group,全部,App1,App2,App3,App4,App5,App6,App7,App8
```

**✅ 良い例:**
```
group,開発環境,VSCode,Docker,Chrome
group,コミュニケーション,Teams,Slack,Zoom
group,業務ツール,Outlook,社内ポータル,タイムカード
```

### 4. グループ名は検索しやすくする

グループを素早く起動できるよう、短く検索しやすい名前にする：

**❌ 悪い例:**
```
group,毎朝の業務開始時に使用する一連のアプリケーション群,Outlook,Teams
```

**✅ 良い例:**
```
group,朝の起動,Outlook,Teams
group,業務開始,Outlook,Teams  # さらに短く
```

## トラブルシューティング

### グループが実行されない

**原因1: グループ内のアイテム名が間違っている**
- data.jsonを確認し、参照しているアイテム名が正確か確認
- 大文字小文字、スペースの有無に注意

**原因2: グループ構文が間違っている**
- `group,`で始まっているか確認
- カンマの区切りが正しいか確認

### 一部のアイテムだけ起動されない

**原因: 存在しないアイテム名を参照している**
- アイテム管理画面（Ctrl+E）でグループ行を確認
- ✏️ボタンで詳細編集し、アイテム名リストを修正

### グループアイテムが表示されない

**原因: data.jsonの構文エラー**
- アイテム管理画面でグループ行が正しく認識されているか確認
- 行の種類が「グループ」と表示されているか確認

## 関連ドキュメント

- **[データファイル形式仕様](../architecture/data-format.md)** - グループの詳細な構文仕様
- **[アイテム管理](../screens/admin-window.md#6-アイテム管理の詳細)** - グループ編集方法の詳細
- **[テストガイド](../testing/README.md)** - テスト方法
- **[開発ガイド](../setup/development.md)** - 実装詳細
