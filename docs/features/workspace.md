# ワークスペース機能

よく使うアイテムをワークスペースに追加して、画面右端の専用ウィンドウで素早くアクセスできる機能です。

## 概要

ワークスペース機能を使うと、メイン画面のアイテムをワークスペースに追加し、グループ化して整理できます。ワークスペースウィンドウは画面右端に固定表示され、ホットキーで素早く表示/非表示を切り替えられます。

### 主な特徴

- **専用ウィンドウ**: 画面右端に固定配置される縦長UI（幅380px）
- **ホットキー対応**: `Ctrl+Alt+W`で表示/非表示を切り替え
- **グループ管理**: アイテムをグループに分類して整理
- **名前変更**: ワークスペース内で独自の名前を設定可能
- **ドラッグ&ドロップ**: アイテムの並び替えやグループ間移動が可能
- **実行履歴**: 直近10件の実行履歴を自動記録
- **独立管理**: 元のアイテムが変更・削除されても影響を受けない

## 基本的な使い方

### ワークスペースウィンドウの表示

ワークスペースウィンドウを表示するには以下の方法があります：

- **ホットキー**: `Ctrl+Alt+W`を押す
- **システムトレイ**: トレイアイコンを右クリック → 「ワークスペースを表示」

### アイテムの追加

ワークスペースにアイテムを追加するには以下の方法があります：

#### メイン画面から追加

1. メイン画面でアイテムを右クリック
2. 「ワークスペースに追加」を選択
3. ワークスペースウィンドウに自動的に追加されます

#### ドラッグ&ドロップで追加

1. エクスプローラーからファイル・フォルダをワークスペースウィンドウにドラッグ
2. ブラウザからURLをワークスペースウィンドウにドラッグ
3. ドロップした場所（グループまたは未分類セクション）に追加されます

#### クリップボードからペースト（Ctrl+V）（v0.5.1以降）

クリップボードの内容をワークスペースに素早く追加できます：

1. **URL・ファイルパス・カスタムURIをコピー**: テキストとしてコピーしたURL、ファイルパス、カスタムURI（`obsidian://`、`vscode://`等）を`Ctrl+V`でペースト
2. **ファイルをコピー**: エクスプローラーでファイル/フォルダを選択して`Ctrl+C`でコピー後、ワークスペースウィンドウで`Ctrl+V`でペースト
3. **自動判定**: ペーストされた内容から自動的にアイテムタイプ（URL、アプリ、ファイル、フォルダ等）を判定
4. **ファビコン自動取得**: URLの場合、ファビコンを自動取得

**対応形式:**
- URL（`http://`、`https://`）
- カスタムURIスキーマ（`obsidian://`、`ms-excel://`、`vscode://`等）
- ファイルパス（絶対パス・相対パス）
- ファイルオブジェクト（エクスプローラーからコピー）

**注意:**
- Input/Textarea要素内でのペーストは通常のテキスト入力として処理されます
- テキストペーストの場合、最初の行のみが使用されます

#### 実行履歴からコピー

1. メイン画面でアイテムを起動すると実行履歴に自動記録
2. 実行履歴アイテムをグループまたは未分類セクションにドラッグ&ドロップ
3. ワークスペースにコピーされます

### アイテムの起動

ワークスペース内のアイテムをクリックすると起動します。

### アイテム名の変更

ワークスペース内でアイテム名を変更できます（元のアイテム名は保持されます）：

1. **ダブルクリック**: アイテムをダブルクリックして編集モードに入る
2. **コンテキストメニュー**: 右クリック → 「名前を変更」

### アイテムの削除

- **削除ボタン**: アイテムの右上の「×」ボタンをクリック
- **コンテキストメニュー**: 右クリック → 「ワークスペースから削除」

## グループ機能

### グループの作成

1. 「+ グループを追加」ボタンをクリック
2. グループが作成され、名前の編集モードになります
3. グループ名を入力してEnterキーを押すか、外側をクリックして確定

### グループ名の編集

- **ダブルクリック**: グループ名をダブルクリック
- **編集ボタン**: グループヘッダーの「✏️」ボタンをクリック

### グループの色設定

グループヘッダーの「🎨」ボタンをクリックして、以下の色から選択できます：

- 青（デフォルト）
- 緑
- 黄
- 赤
- 紫
- ピンク
- オレンジ
- 水色

### グループの折りたたみ

グループヘッダーの「▼」または「▶」ボタンをクリックして、グループを折りたたみ/展開できます。

### グループの削除

グループヘッダーの「🗑️」ボタンをクリックしてグループを削除できます。
グループ内のアイテムは未分類セクションに移動します。

### グループの並び替え

グループヘッダー（名前部分以外）をドラッグ&ドロップして、グループの順序を変更できます。

## アイテムの整理

### グループ間の移動

アイテムをドラッグして別のグループにドロップすることで、所属グループを変更できます。

### 同じグループ内の並び替え

同じグループ内でアイテムをドラッグ&ドロップして、順序を変更できます。

### 未分類アイテム

グループに所属していないアイテムは「未分類」セクションに表示されます。

## 実行履歴機能

### 自動記録

メイン画面でアイテムを起動すると、実行履歴に自動的に記録されます。

### 表示内容

- **最大10件**: 直近10件の実行履歴を保持
- **実行時刻**: 各アイテムの右上に実行時刻を表示
- **ツールチップ**: アイテムにマウスオーバーで詳細情報（パス、実行日時）を表示

### 再起動

実行履歴アイテムをクリックすると、再度起動できます。

### ワークスペースへのコピー

実行履歴アイテムをグループまたは未分類セクションにドラッグ&ドロップすると、ワークスペースにコピーできます。

## コンテキストメニュー

ワークスペース内のアイテムを右クリックすると、以下のメニューが表示されます：

| メニュー項目 | 説明 | 対象アイテム |
|------------|------|------------|
| **名前を変更** | ワークスペース内での表示名を編集 | 全アイテム |
| **起動** | アイテムを起動 | 全アイテム |
| **パスをコピー** | アイテムのパスをクリップボードにコピー | 全アイテム |
| **親フォルダーのパスをコピー** | 親フォルダーのパスをコピー | ファイル・アプリ・フォルダ |
| **親フォルダーを開く** | 親フォルダーをエクスプローラーで開く | ファイル・アプリ・フォルダ |
| **リンク先のパスをコピー** | ショートカットのリンク先パスをコピー | ショートカット |
| **リンク先の親フォルダーのパスをコピー** | リンク先の親フォルダーのパスをコピー | ショートカット |
| **リンク先の親フォルダーを開く** | リンク先の親フォルダーを開く | ショートカット |
| **グループから削除** | グループから削除して未分類に移動 | グループ所属アイテム |
| **ワークスペースから削除** | ワークスペースから完全に削除 | 全アイテム |

## ツールチップ

### ワークスペースアイテム

アイテムにマウスオーバーすると以下の情報を表示：

- パス
- リンク先（ショートカットの場合）
- 引数（設定されている場合）
- 元の名前（変更している場合）
- 追加日時

### 実行履歴アイテム

実行履歴アイテムにマウスオーバーすると以下の情報を表示：

- パス
- 実行日時

## データ保存

ワークスペースのデータは以下のファイルに保存されます：

| ファイル | 内容 | 形式 |
|---------|------|------|
| **workspace.json** | ワークスペースアイテムとグループ | JSON（electron-store） |
| **execution-history.json** | 実行履歴（最大10件） | JSON（electron-store） |

### 保存場所

```
%APPDATA%/quick-dash-launcher/config/
├── workspace.json
└── execution-history.json
```

### データ形式

詳細なデータ形式は[データファイル形式](../architecture/data-format.md#ワークスペースデータ)を参照してください。

## ウィンドウのカスタマイズ

### 透過機能

ワークスペースウィンドウの透過度を調整できます（設定画面で変更可能）：

- **透過度スライダー**: 0-100%で調整（デフォルト: 100%）
- **背景のみ透過モード**: ウィンドウ背景のみを透過し、アイテムやボタンは不透明のまま表示
- **即座反映**: 設定変更は即座にワークスペースウィンドウに反映されます

詳細は[アプリケーション設定 - ワークスペースウィンドウ](settings.md#ワークスペースウィンドウ)を参照してください。

### サイズ変更

ワークスペースウィンドウはカスタムサイズ変更ハンドルで自由にリサイズできます：

- **8方向のハンドル**: 4隅（左上、右上、右下、左下）+ 4辺（上、右、下、左）
- **最小サイズ**: 幅300px × 高さ400px
- **ドラッグ操作**: ハンドルをドラッグしてウィンドウをリサイズ

### ウィンドウ制御

- **ピン留め**: ヘッダーの📌ボタンで常に最前面表示の切り替え
- **閉じる**: ヘッダーの×ボタンでウィンドウを非表示（`Ctrl+Alt+W`で再表示可能）

## キーボードショートカット

| キー | 動作 |
|------|------|
| `Ctrl+Alt+W` | ワークスペースウィンドウの表示/非表示切り替え |
<<<<<<< HEAD
| `Ctrl+V` | クリップボードからアイテムを追加（URL、ファイルパス、ファイルオブジェクト） |
=======
| `Ctrl+V` | クリップボードからファイル・フォルダ・URLをペーストして追加（v0.5.1以降） |
>>>>>>> origin/main
| `Enter` | 編集モードで名前を確定 |
| `Escape` | 編集モードをキャンセル |

## 技術仕様

### ウィンドウ仕様

- **初期サイズ**: 幅380px × 高さ（画面の高さに合わせて自動調整）
- **サイズ変更**: 8方向のカスタムハンドルで自由にリサイズ可能（最小: 300x400px）
- **位置**: 画面右端に固定（初期配置）
- **表示**: 常に最前面（AlwaysOnTop）、ピン留めボタンで切り替え可能
- **フレーム**: フレームレス（カスタムヘッダー、ドラッグ移動・リサイズ対応）
- **透過度**: 0-100%で調整可能（デフォルト: 100%）
- **背景のみ透過**: ウィンドウ背景のみを透過するモード（オプション）

### データ永続化

- **ストレージ**: electron-store（JSON形式）
- **保存タイミング**: アイテム追加・編集・削除・並び替え時に即座に保存
- **バックアップ**: 自動バックアップなし（手動でconfig/workspace.jsonをバックアップ可能）

### パフォーマンス

- **最大アイテム数**: 制限なし（推奨: 50アイテム程度）
- **最大グループ数**: 制限なし（推奨: 10グループ程度）
- **実行履歴**: 最大10件（古いものから自動削除）

### 型安全性

ドラッグ&ドロップ操作は型安全な構造で実装されています：

**DragItemData型**: ドラッグされているアイテムの種別と情報を表現
- `workspace-item`: ワークスペースアイテム（アイテムID、所属グループID）
- `history-item`: 実行履歴アイテム（LauncherItem）
- `group`: グループ（グループID）

**DropTargetData型**: ドロップ先の種別と識別子を表現
- `group`: グループ（グループID）
- `item`: アイテム（アイテムID）
- `uncategorized`: 未分類セクション

詳細は[データファイル形式 - DragItemData/DropTargetData](../architecture/data-format.md#dragitemdata)を参照してください。

## トラブルシューティング

### ワークスペースウィンドウが表示されない

- `Ctrl+Alt+W`を押して表示を試みる
- システムトレイから「ワークスペースを表示」を選択

### アイテムが起動しない

- アイテムのパスが正しいか確認
- 元のアイテム（ファイル・アプリ）が削除されていないか確認

### データが消えた

- `%APPDATA%/quick-dash-launcher/config/workspace.json`が存在するか確認
- バックアップから復元する場合は、workspace.jsonをconfig/フォルダにコピー

## 関連ドキュメント

- **[ワークスペースウィンドウ画面仕様](../screens/workspace-window.md)** - 画面の詳細仕様
- **[データファイル形式](../architecture/data-format.md)** - workspace.json形式
- **[IPC通信](../architecture/ipc-channels.md)** - ワークスペース関連のIPCチャネル
- **[キーボードショートカット](keyboard-shortcuts.md)** - 全ショートカット一覧
