# アプリケーション設定

QuickDashLauncherの動作をカスタマイズするための設定機能の使い方を説明します。

設定項目の詳細な仕様については、**[アプリケーション設定仕様](../reference/settings-specification.md)** を参照してください。

## 初回起動時の設定

アプリケーションを初めて起動した際、または設定ファイルの`hotkey`項目が空の場合、初回設定画面が自動的に表示されます。

### 初回設定画面

初回設定画面では、アプリケーションを呼び出すためのグローバルホットキーを設定します。

#### 設定手順

1. **グローバルホットキー設定**
   - 入力欄をクリックして、希望するキー組み合わせを実際に押下（例：`Ctrl+Alt+Q`）
   - リアルタイムでバリデーションが実行され、使用可能かチェックされます
   - デフォルトは `Alt+Space` が入力されています
   - ヒント: 修飾キー（Ctrl、Alt、Shift等）と通常キーを組み合わせてください

2. **設定完了**
   - 「設定を完了」ボタンをクリックして、入力したホットキーを保存
   - 設定完了後、メインウィンドウが表示されます

#### 動作詳細

- **表示条件**: 設定ファイルの`hotkey`項目が空文字列または未設定の場合
- **自動表示**: スプラッシュウィンドウ終了後に自動的に表示されます
- **閉じられない**: 初回設定が完了するまで、ESCキーやフォーカス喪失では閉じません
- **再設定可能**: ホットキーは後から設定画面で変更可能です

### 開発者向け情報

初回設定画面をスキップしたい場合は、設定ファイル（`%APPDATA%/quick-dash-launcher/config/settings.json`）を直接編集して`hotkey`に任意の値（例: `"Alt+Space"`）を設定してください。

## 設定画面へのアクセス

設定画面は以下の方法でアクセスできます：

1. **基本設定タブ**：⚙ボタン → 「⚙️ 基本設定」をクリック
2. **アイテム管理タブ**：⚙ボタン → 「✏️ アイテム管理」をクリック
3. **その他タブ**：⚙ボタン → 「📊 その他」をクリック

設定画面は「基本設定」「アイテム管理」「その他」の3つのタブで構成されています。

### その他タブでできること

「その他」タブでは、以下の機能にアクセスできます：

- **ファイル管理**
  - 📁 設定フォルダを開く：エクスプローラーで設定フォルダを開きます
  - 📄 データファイルを開く：`data.txt`をテキストエディタで開きます

- **アプリケーション情報**
  - バージョン番号とライセンス情報を確認できます
  - 🔗 GitHubリポジトリボタンでプロジェクトページを開けます

- **ショートカット一覧**
  - 利用可能なキーボードショートカットの一覧が表示されます

- **アプリケーション制御**
  - 🚪 アプリケーションを終了：アプリケーションを完全に終了します

## 主要な設定項目

### グローバルホットキー

アプリケーションを呼び出すためのキー組み合わせを設定できます（デフォルト: `Alt+Space`）。

#### 設定方法

1. 「グローバルホットキー」の入力欄をクリック
2. 希望するキー組み合わせを実際に押下（例：`Ctrl+Alt+Q`）
3. リアルタイムでバリデーションが実行され、使用可能かチェックされます
4. 「保存」ボタンをクリックで設定を保存

#### 設定例

```
Ctrl+Alt+Q
Ctrl+Shift+L
Alt+F1
```

### ウィンドウサイズ

通常時とアイテム管理時のウィンドウサイズをそれぞれカスタマイズできます。

- **通常時**: 幅400-2000px、高さ300-1200px
- **アイテム管理時**: 幅800-2000px、高さ600-1200px

### ウィンドウピン留めモード

ウィンドウの固定表示動作を3段階で制御できます。📌ボタンをクリックするたびに、以下の順序でモードが切り替わります。

#### ピン留めモードの種類

**通常モード（デフォルト）**
- フォーカスが外れると自動的に非表示になります
- アイテム起動後も自動的に非表示になります
- 最上面には表示されません
- ランチャーとして最も一般的な動作です

**常に最上面モード**
- 常に最上面に表示されます
- フォーカスが外れても非表示になりません
- アイテム起動後も表示されたままです
- 他のウィンドウに隠れることなく、常にアクセス可能な状態を維持します

**表示固定モード**
- 最上面には表示されません（他のウィンドウに隠れることがあります）
- フォーカスが外れても非表示になりません
- アイテム起動後も表示されたままです
- 通常のウィンドウとして動作しつつ、自動非表示を無効化します

#### 使い分けのヒント

- **通常モード**: ホットキーで素早く呼び出して使う場合（デフォルト推奨）
- **常に最上面モード**: 常にアクセス可能にしたい場合、複数のアイテムを連続して開く場合
- **表示固定モード**: 他のウィンドウと並べて使いたいが、自動非表示は避けたい場合

### ウィンドウ表示位置

ホットキーでウィンドウを表示する際の位置を設定できます。

#### 設定方法

1. 「基本設定」タブを開く
2. 「ウィンドウ表示位置」セクションで、以下の3つのモードから選択

#### 表示位置モード

**画面中央（デフォルト）**
- ウィンドウを常に画面中央に表示します
- 最もシンプルで使いやすいモードです

**マウスカーソルの位置**
- ウィンドウをマウスカーソルの位置を中心に表示します
- カーソル位置がウィンドウの中心になるように配置されます
- 画面外にはみ出さないように自動的に調整されます
- マルチモニター環境では、カーソルがあるモニターに表示されます

**用途例**:
- マウス操作中心の作業で、カーソル位置から素早くアクセスしたい場合
- 複数モニターを使用していて、作業中のモニターに表示したい場合

**固定位置（手動で移動した位置を記憶）**
- ウィンドウを手動で移動すると、その位置が自動的に記憶されます
- 次回表示時には、記憶された位置に表示されます
- 初回表示時は画面中央に配置され、その位置が保存されます

**用途例**:
- いつも同じ位置で使用したい場合
- 特定のモニターの特定の位置に固定したい場合

#### ウィンドウ位置のリセット

固定位置モードで画面外に配置されてしまった場合や、一時的に画面中央で使用したい場合は、システムトレイメニューから「画面中央に表示」を選択してください。

#### 動作詳細

**即座反映**: ラジオボタンを変更すると設定が即座に保存されます。

**固定位置の自動保存**:
- 固定位置モードを選択している場合、ウィンドウを手動で移動すると自動的に位置が保存されます
- 設定ファイル（`settings.json`）の`windowPositionX`と`windowPositionY`に座標が記録されます

**タスクトレイからの表示**:
- システムトレイアイコンから「表示」を選択した場合も、設定された表示位置モードに従います
- 「画面中央に表示」を選択した場合は、設定に関係なく強制的に画面中央に表示されます

### 自動起動

Windowsログイン時に自動的にアプリケーションを起動するかを設定できます（デフォルト: 無効）。

#### 設定方法

1. 「基本設定」タブを開く
2. 「起動時に自動実行」チェックボックスをクリック
3. 設定が即座に保存され、システムに反映されます

#### 動作詳細

**NSISインストーラー版**:
- Windows起動時に`Update.exe`経由でアプリケーションが起動します
- Windowsレジストリ（`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`）に登録されます

**ポータブル版**:
- 実行ファイルが直接起動されます
- Windowsレジストリに登録されます

**開発環境**:
- パッケージ化されていないため、自動起動設定はスキップされます
- 設定画面でチェックボックスを変更しても、実際には登録されません

#### トラブルシューティング

- **自動起動が動作しない**: Windowsのタスクマネージャー → スタートアップタブで設定を確認してください
- **複数起動してしまう**: レジストリに重複登録されている可能性があります。一度無効化してから再度有効化してください

### バックアップ設定

データファイルの自動バックアップに関する設定を行います。

#### バックアップ機能を有効にする

バックアップ機能全体のON/OFFを切り替えます。無効にすると、すべてのバックアップ処理が停止します（デフォルト: 無効）。

#### バックアップのタイミング

以下の2つのタイミングでバックアップを作成できます：

1. **アプリ起動時**: アプリケーション起動時に`data.txt`と`data2.txt`をバックアップ（デフォルト: 無効）
2. **データ編集時**: アイテム管理や生データ編集でデータを変更した際に自動バックアップ（デフォルト: 無効）

#### バックアップの制御

- **最小バックアップ間隔**: 1～60分で設定可能（デフォルト: 5分）
  - 頻繁な編集による過剰なバックアップ作成を防ぎます
- **バックアップ保存件数**: 1～100件で設定可能（デフォルト: 20件）
  - 上限を超えると古いバックアップから自動的に削除されます

#### バックアップファイルの確認

バックアップファイルは `%APPDATA%/quick-dash-launcher/config/backup/` に保存されます。

ファイル名形式: `data_2024-01-01T12-00-00.txt`

### タブ表示設定

複数のデータファイル（data.txt, data2.txt, data3.txt...）をタブで切り替えて使用できます。1つのタブに複数のデータファイルを関連付けて統合表示することも可能です。

#### 複数タブを表示

タブ表示のON/OFFを切り替えます（デフォルト: 無効）。

- **ON**: メインウィンドウに各タブが表示されます
- **OFF**: data.txtのみが表示されます

**即座反映**: チェックボックスを変更すると設定が即座に保存され、メインウィンドウに反映されます。

**v1.0.0以降の変更**: チェックボックスのラベルが「複数データファイルをタブで表示」から「複数タブを表示」に変更されました。

#### タブ管理

タブ表示をONにすると、タブ一覧が表示され、以下の操作が可能になります：

**タブの追加:**
- **➕行追加**ボタンをクリック
- 次の番号のファイル（例: data2.txt, data3.txt...）が自動的に作成されます
- 新しいタブエントリが設定の`dataFileTabs`配列に自動的に追加されます
- 物理ファイルも同時に作成されます
- 作成されたタブは即座に設定画面のリストに表示されます

**タブ名のカスタマイズ:**
- 各タブにカスタムタブ名を設定できます
- タブ名が未設定の場合は、わかりやすいデフォルト名が表示されます
  - data.txt → 「メイン」
  - data2.txt → 「サブ1」
  - data3.txt → 「サブ2」
- タブ名を入力すると設定が即座に保存され、メインウィンドウのタブ名がリアルタイムに更新されます
- 設定例: data.txt → "仕事用"、data2.txt → "プライベート"

**複数ファイルの統合表示:**
- 1つのタブに複数のデータファイルを関連付けることができます
- 設定画面では、各タブの「ファイル」欄に複数のファイル名が表示されます
- 統合表示されたタブでは、関連付けられたすべてのファイルのアイテムが一覧表示されます
- 例: 「プライベート」タブにdata2.txtとdata3.txtを関連付けると、両方のファイルのアイテムが1つのタブに表示されます

**デフォルト保存先の指定:**
- 1つのタブに複数のデータファイルが関連付けられている場合、アイテム登録時のデフォルト保存先を指定できます
- 設定画面の各タブ行で、デフォルト保存先ファイルを選択できます
- 未設定の場合は、関連付けられたファイルの最初のファイルがデフォルトになります

**タブの表示順序:**
- 各行の▲▼ボタンでタブの順序を変更
- 順序変更は即座に保存され、メインウィンドウに反映されます
- `dataFileTabs`配列の順序がそのまま表示順序になります

**タブの削除:**
- 🗑️ボタンをクリックして不要なタブを削除
- タブを削除しても、関連付けられたデータファイルは削除されません
- 削除されるのは設定の`dataFileTabs`配列から該当エントリのみです
- データファイル自体は保持され、他のタブに関連付けることができます

**ファイルの追加・削除:**
- **➕ファイル追加**ボタンで新しいデータファイルを作成
- **🗑️ファイル削除**ボタンでデータファイルを削除
- **注意**: data.txtは削除できません（必須ファイル）
- ファイルを削除すると、物理ファイルも削除されます
- 削除されたファイル内のデータは完全に失われます

**設定フォルダを開く:**
- **📁フォルダを開く**ボタンでエクスプローラーから直接ファイルを確認できます

**アイテム登録時の保存先選択:**
- アイテム登録モーダル（➕ボタン、ドラッグ&ドロップ、編集）で保存先を選択できます
- 1つのタブに複数ファイルが関連付けられている場合、個別のファイル名も選択肢として表示されます
- 新規登録時のデフォルト保存先:
  - タブの最初のファイル（`files[0]`）が使用されます
- 編集時は現在のアイテムが保存されているファイルがデフォルト選択されます

**v1.0.0以降の変更**:
- セクション名が「データファイル管理」から「タブ管理」に変更されました
- 説明文が「複数のデータファイルを作成して、タブで切り替えることができます」から「複数のタブを作成して切り替えることができます」に変更されました
- 1つのタブで複数のデータファイルを統合表示できるようになりました
- タブの削除とファイルの削除が分離されました

#### デフォルトタブ

アプリ起動時に最初に表示するタブのファイル名を指定します（デフォルト: data.txt）。

- 指定したファイルが存在しない場合は、自動的にdata.txtが表示されます

## 設定の保存と適用

### 即座反映

**v1.0.0以降の変更**: すべての設定変更が「保存」ボタンなしで即座に反映されます。

- 設定を変更すると自動的に保存されます
- 設定ファイル（`settings.json`）に即座に書き込まれます
- メインウィンドウがある場合は自動的に設定が反映されます
- 再起動は不要です

### 設定のリセット

「リセット」ボタンをクリックすると、全ての設定がデフォルト値に戻ります。

### 設定ファイルの直接編集

上級者向けの機能として、設定ファイルを直接編集することも可能です：

1. 設定メニュー → 「📄 設定ファイルを開く」
2. テキストエディタで編集
3. アプリケーションを再起動

設定ファイルは `%APPDATA%/quick-dash-launcher/config/settings.json` に保存されています。

## トラブルシューティング

### ホットキーが動作しない

1. **他のアプリケーションとの競合**
   - 異なるキー組み合わせに変更してください
   
2. **管理者権限での実行**
   - 一部のアプリケーションとの連携で必要な場合があります

3. **設定の破損**
   - 設定をデフォルトにリセットしてください

### 設定が保存されない

1. **書き込み権限の確認**
   - 設定フォルダへの書き込み権限があるか確認
   
2. **ディスク容量の確認**
   - 十分な空き容量があるか確認

## 関連ドキュメント

- **[アプリケーション設定仕様](../reference/settings-specification.md)** - 設定項目の詳細仕様
- **[キーボードショートカット](../reference/keyboard-shortcuts.md)** - 利用可能なショートカット一覧
- **[はじめに](../guides/getting-started.md)** - 基本的な使い方