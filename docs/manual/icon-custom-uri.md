# カスタムURIアイコン

カスタムURIスキーマ（例: `obsidian://`、`ms-excel://`）のアイコンは、Windowsレジストリから関連付けられたアプリケーションを検索して取得します。

カスタムURIアイコン取得の詳細な仕様については、**[アイコン仕様 - カスタムURIアイコン取得仕様](../reference/icon-specification.md#カスタムuriアイコン取得仕様)** を参照してください。

## 使い方

### 個別取得

1. アイテム管理画面（Ctrl+E）を開く
2. カスタムURIアイテムを選択
3. コンテキストメニューから「アイコンを抽出」を選択

### 一括取得

1. メインウィンドウ（Alt+Space）を開く
2. ヘッダーの🔄ボタンをクリック
3. ドロップダウンメニューから「🎨 アイコン取得」を選択
4. 進捗表示を確認しながら待機
5. 完了後、自動的にアイコンが適用されます

**注:** この機能は**アイコンが未設定のカスタムURIアイテムのみ**を対象とします。

## 取得の仕組み

カスタムURIアイコンは以下の優先順位で取得を試行します：

1. **レジストリベース**: Windowsレジストリからスキーマハンドラーアプリを検索してアイコンを抽出
2. **拡張子ベース**: URIに対応する拡張子のアイコン（例: `ms-excel://` → `.xlsx`）
3. **デフォルト**: 🔗絵文字

レジストリベースの取得では、URIスキーマからWindowsレジストリを照会し、関連付けられたアプリケーションの実行ファイルを特定してアイコンを抽出します。

## 対応URIスキーマ例

| URIスキーマ | ハンドラーアプリ | アイコン |
|------------|--------------|--------|
| `obsidian://` | Obsidian.exe | Obsidianアプリアイコン |
| `ms-excel://` | EXCEL.EXE | Microsoft Excelアイコン |
| `vscode://` | Code.exe | Visual Studio Codeアイコン |
| `steam://` | steam.exe | Steamアイコン |
| `slack://` | slack.exe | Slackアイコン |

## 関連ドキュメント

- **[アイコン仕様](../reference/icon-specification.md)** - カスタムURIアイコン取得の詳細仕様
- **[アイコンシステム](icon-system.md)** - アイコンシステム全体の概要
- **[ファビコン取得システム](icon-favicon.md)** - ファビコン取得の使い方